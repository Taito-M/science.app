<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Orbital Postcards â€“ æ˜ã‚‹ã„è»Œé“ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ (v1.1)</title>
<style>
  :root{
    --bg:#ffffff;
    --ink:#1f2937; /* slate-800 */
    --sub:#6b7280; /* slate-500 */
    --accent:#7EC8E3; /* ãƒ‘ã‚¹ãƒ†ãƒ«æ°´è‰² */
    --accent2:#FFD166; /* ãƒ‘ã‚¹ãƒ†ãƒ«é»„ */
    --panel:#f7fafc; /* very light */
    --chip:#eef6fb;
    --grid:#eef2f7;
  }
  html,body{height:100%;}
  body{
    margin:0; background:var(--bg); color:var(--ink);
    font-family: system-ui, -apple-system, Segoe UI, Roboto, "Hiragino Kaku Gothic ProN", Meiryo, "Noto Sans JP", sans-serif;
    line-height:1.5;
  }
  header{
    display:flex; align-items:center; justify-content:space-between;
    padding:14px 20px; border-bottom:1px solid #e5e7eb; position:sticky; top:0; background:var(--bg); z-index:10;
  }
  .brand{font-weight:800; letter-spacing:.3px; font-size:20px;}
  .brand small{font-weight:600; color:var(--sub); margin-left:.5rem;}
  .accent-bar{height:6px; background: linear-gradient(90deg, var(--accent), var(--accent2));}

  .wrap{display:grid; grid-template-columns: 1fr 320px; gap:12px; padding:12px; height: calc(100% - 66px);}
  @media (max-width: 900px){
    .wrap{grid-template-columns: 1fr; height:auto;}
  }

  #stage{position:relative; background:var(--panel); border-radius:16px; box-shadow: 0 2px 12px rgba(0,0,0,.05);}
  canvas{display:block; width:100%; height:100%; border-radius:16px;}
  .hud{position:absolute; left:12px; top:12px; display:flex; gap:8px; flex-wrap:wrap;}
  .chip{background:var(--chip); color:#0f172a; border:1px solid #dbeafe; padding:6px 10px; border-radius:999px; font-size:12px; box-shadow:0 1px 0 rgba(0,0,0,.04);}

  .panel{background:var(--panel); border-radius:16px; padding:14px; box-shadow: 0 2px 12px rgba(0,0,0,.05);}
  .panel h2{font-size:16px; margin:4px 0 10px;}
  .row{margin:10px 0 14px;}
  .row label{font-size:13px; color:var(--sub); display:flex; justify-content:space-between;}
  .row .val{margin-left:8px; font-weight:700; color:#0f172a;}
  input[type=range]{width:100%;}
  .btns{display:flex; flex-wrap:wrap; gap:8px; margin-top:8px;}
  .btn{appearance:none; border:none; background: var(--accent); color:#053b53; padding:10px 14px; border-radius:12px; font-weight:700; cursor:pointer;}
  .btn.secondary{background:#e2e8f0; color:#0f172a;}
  .btn.warn{background:var(--accent2); color:#5b3f00;}
  .tog{display:flex; align-items:center; gap:8px; font-size:14px;}
  .small{font-size:12px; color:var(--sub);}
  .help{margin-top:8px; font-size:12px; color:var(--sub);}

  footer{padding:8px 14px 16px; text-align:center; color:var(--sub);}
</style>
</head>
<body>
  <header>
    <div class="brand">Orbital Postcards <small>ã‚±ãƒ—ãƒ©ãƒ¼ã®æ³•å‰‡ã‚’â€œæ‰‹ã–ã‚ã‚Šâ€ã§</small></div>
    <div class="tog"><input id="toggleGrid" type="checkbox" checked><label for="toggleGrid">è–„ã„ã‚¬ã‚¤ãƒ‰è¡¨ç¤º</label></div>
  </header>
  <div class="accent-bar"></div>

  <div class="wrap">
    <section id="stage">
      <canvas id="sim" aria-label="è»Œé“ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚­ãƒ£ãƒ³ãƒã‚¹"></canvas>
      <div class="hud" id="hud"></div>
    </section>

    <aside class="panel">
      <h2>è¨­å®šï¼ˆå˜ä½ã¯ç›¸å¯¾ï¼‰</h2>
      <div class="row">
        <label for="a">åŠé•·è»¸ a <span class="val" id="aVal">1.00</span></label>
        <input id="a" type="range" min="0.6" max="5" step="0.01" value="1" />
      </div>
      <div class="row">
        <label for="e">é›¢å¿ƒç‡ e <span class="val" id="eVal">0.20</span></label>
        <input id="e" type="range" min="0" max="0.9" step="0.01" value="0.20" />
      </div>
      <div class="row">
        <label for="speed">å†ç”Ÿé€Ÿåº¦ Ã— <span class="val" id="speedVal">1.0</span></label>
        <input id="speed" type="range" min="0.2" max="8" step="0.1" value="1" />
      </div>
      <div class="row">
        <label for="blink">ç‚¹æ»…ã®å¼·ã• <span class="val" id="blinkVal">0.00</span></label>
        <input id="blink" type="range" min="0" max="2" step="0.05" value="0" />
      </div>
      <div class="row">
        <label>è¡¨ç¤º</label>
        <div class="tog"><input id="showSectors" type="checkbox" checked><label for="showSectors">ç­‰é¢ç©â€œæ‰‡å½¢â€ã‚’è¡¨ç¤º</label></div>
        <div class="tog"><input id="showTrail" type="checkbox" checked><label for="showTrail">è»Œè·¡ï¼ˆè–„ã„ç·šï¼‰</label></div>
        <div class="tog"><input id="showAreal" type="checkbox" checked><label for="showAreal">é¢ç©é€Ÿåº¦ã‚¹ãƒˆãƒªãƒ¼ãƒ</label></div>
      </div>
      <div class="row">
        <label for="awindow">ã‚¹ãƒˆãƒªãƒ¼ãƒè¡¨ç¤ºæ™‚é–“ s <span class="val" id="awVal">3.0</span></label>
        <input id="awindow" type="range" min="0.5" max="8" step="0.1" value="3" />
      </div>
      <div class="btns">
        <button class="btn" id="play">â–¶ å†ç”Ÿ</button>
        <button class="btn secondary" id="pause">â¸ åœæ­¢</button>
        <button class="btn secondary" id="reset">â†º ãƒªã‚»ãƒƒãƒˆ</button>
        <button class="btn warn" id="save">ğŸ–¼ ãƒã‚¹ãƒˆã‚«ãƒ¼ãƒ‰ä¿å­˜</button>
      </div>
      <p class="help">ãƒ’ãƒ³ãƒˆï¼šç­‰æ™‚é–“ã”ã¨ã®â€œæ‰‡å½¢â€é¢ç©ãŒå¸¸ã«åŒã˜ â†’ <b>ã‚±ãƒ—ãƒ©ãƒ¼ç¬¬2æ³•å‰‡</b>ã€‚æ¥•å†† + å¤ªé™½ãŒç„¦ç‚¹ â†’ <b>ç¬¬1æ³•å‰‡</b>ã€‚<br>åŠé•·è»¸ a ã‚’å¤‰ãˆã‚‹ã¨å‘¨æœŸ T âˆ a<sup>3/2</sup> â†’ <b>ç¬¬3æ³•å‰‡</b>ã€‚</p>
      <p class="small">â€» å˜ä½ç³»ã¯ GM=1 ã®ç›¸å¯¾è¡¨ç¤ºã€‚æ•™æç”¨ã«æœ€å°æ§‹æˆã§å®Ÿè£…ã—ã¦ã„ã¾ã™ï¼ˆå®Œå…¨ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ï¼‰ã€‚</p>
    </aside>
  </div>

  <footer>Â© 2025 Orbital Postcards â€“ lightweight classroom edition</footer>

<script>
(()=>{
  // ====== åŸºæœ¬çŠ¶æ…‹ ======
  const canvas = document.getElementById('sim');
  const ctx = canvas.getContext('2d');
  const hud = document.getElementById('hud');

  const ui = {
    a: document.getElementById('a'), aVal: document.getElementById('aVal'),
    e: document.getElementById('e'), eVal: document.getElementById('eVal'),
    speed: document.getElementById('speed'), speedVal: document.getElementById('speedVal'),
    blink: document.getElementById('blink'), blinkVal: document.getElementById('blinkVal'),
    play: document.getElementById('play'), pause: document.getElementById('pause'),
    reset: document.getElementById('reset'), save: document.getElementById('save'),
    showSectors: document.getElementById('showSectors'), showTrail: document.getElementById('showTrail'),
    showAreal: document.getElementById('showAreal'), awindow: document.getElementById('awindow'), awVal: document.getElementById('awVal'),
    toggleGrid: document.getElementById('toggleGrid'),
  };

  // ç‰©ç†å®šæ•°ï¼ˆç›¸å¯¾å˜ä½ï¼‰
  const MU = 1.0; // G*M
  let a = parseFloat(ui.a.value);     // åŠé•·è»¸
  let e = parseFloat(ui.e.value);     // é›¢å¿ƒç‡
  let t = 0;                          // çµŒéæ™‚é–“ï¼ˆç›¸å¯¾ï¼‰
  let playing = false;
  let lastTs = 0;
  let trail = []; // ä½ç½®å±¥æ­´ï¼ˆæç”»ç”¨ï¼‰
  const TRAIL_MAX = 800;

  // é¢ç©é€Ÿåº¦ã‚¹ãƒˆãƒªãƒ¼ãƒè¨­å®š
  let arealWindow = 3.0; // ç§’ï¼ˆç›¸å¯¾ï¼‰
  const AREAL_STEPS = 90; // ã‚¦ã‚§ãƒƒã‚¸åˆ†å‰²

  // ã‚»ã‚¯ã‚¿ãƒ¼ï¼ˆç­‰æ™‚é–“ï¼‰è¨­å®š
  let sectors = [];
  const N_SECT = 16;     // æ‰‡å½¢ã®æ•°ï¼ˆ1å‘¨ã‚’åˆ†å‰²ï¼‰
  const ARC_STEPS = 18;  // æ‰‡å½¢ã®è¾ºã‚’æ»‘ã‚‰ã‹ã«ã™ã‚‹ã‚µãƒ³ãƒ—ãƒ«æ•°

  function period(a){ return 2*Math.PI*Math.sqrt(a*a*a/MU); }
  function meanMotion(a){ return Math.sqrt(MU/(a*a*a)); }

  // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒ»ã‚­ãƒ£ãƒ³ãƒã‚¹è¨­å®š
  function resize(){
    const dpr = Math.max(1, Math.min(3, window.devicePixelRatio || 1));
    const rect = canvas.parentElement.getBoundingClientRect();
    canvas.width = Math.floor(rect.width * dpr);
    canvas.height = Math.floor(rect.height * dpr);
    canvas.style.width = rect.width + 'px';
    canvas.style.height = rect.height + 'px';
    ctx.setTransform(dpr,0,0,dpr,0,0);
  }
  window.addEventListener('resize', ()=>{ resize(); });

  // ã‚±ãƒ—ãƒ©ãƒ¼æ–¹ç¨‹å¼ E - e sinE = M ã‚’è§£ã
  function solveKepler(M, e){
    // M ã‚’ 0..2Ï€ ã«æ­£è¦åŒ–
    M = (M % (2*Math.PI) + 2*Math.PI) % (2*Math.PI);
    let E = e < 0.8 ? M : Math.PI; // åˆæœŸå€¤
    for(let i=0;i<12;i++){
      const f = E - e*Math.sin(E) - M;
      const fp = 1 - e*Math.cos(E);
      E = E - f/fp;
    }
    return E;
  }

  // Eâ†’çœŸè¿‘ç‚¹é›¢è§’Î½ã¨åŠå¾„r
  function stateFromE(a,e,E){
    const cosE = Math.cos(E), sinE = Math.sin(E);
    const r = a*(1 - e*cosE);
    const nu = Math.atan2( Math.sqrt(1-e*e)*sinE, cosE - e );
    return {r, nu};
  }

  // é€Ÿåº¦ï¼ˆã‚¹ã‚«ãƒ©ãƒ¼ï¼‰ v = sqrt(mu*(2/r - 1/a))
  function speed(a, r){ return Math.sqrt(MU*(2/r - 1/a)); }

  // ã‚·ãƒ¼ãƒ³åº§æ¨™å¤‰æ›ï¼ˆç„¦ç‚¹ï¼åŸç‚¹â†’ã‚­ãƒ£ãƒ³ãƒã‚¹ï¼‰
  function getScaleAndOrigin(){
    const W = canvas.clientWidth, H = canvas.clientHeight;
    const rMax = a*(1+e); // ã‚¢ãƒ•ã‚§ãƒªã‚ªãƒ³è·é›¢ãŒæœ€å¤§
    const m = 0.45 * Math.min(W, H) / rMax; // ä½™ç™½è¾¼ã¿ã§åã‚ã‚‹
    return { m, cx: W*0.52, cy: H*0.5 }; // å°‘ã—å³å¯„ã›ã«ã—ã¦è¦‹ã‚„ã™ã
  }
  function toXY(r, nu){
    const {m,cx,cy} = getScaleAndOrigin();
    const x = cx + m * r * Math.cos(nu);
    const y = cy + m * r * Math.sin(nu);
    return {x,y};
  }

  // æ‰‡å½¢ï¼ˆç­‰æ™‚é–“ï¼‰ã‚’å†è¨ˆç®—
  function recomputeSectors(){
    sectors.length = 0;
    const T = period(a);
    for(let i=0;i<N_SECT;i++){
      const t0 = i*T/N_SECT;
      const t1 = (i+1)*T/N_SECT;
      sectors.push({t0,t1});
    }
  }

  // HUD æ›´æ–°
  function setChip(text){
    hud.innerHTML = '';
    const c = document.createElement('div'); c.className = 'chip'; c.textContent = text; hud.appendChild(c);
  }

  // ã‚°ãƒªãƒƒãƒ‰æç”»
  function drawGrid(){
    if(!ui.toggleGrid.checked) return;
    const W = canvas.clientWidth, H = canvas.clientHeight;
    const grid = getComputedStyle(document.documentElement).getPropertyValue('--grid');
    ctx.save();
    ctx.strokeStyle = grid;
    ctx.lineWidth = 1;
    const step = 50; // px
    ctx.beginPath();
    for(let x=0;x<=W;x+=step){ ctx.moveTo(x,0); ctx.lineTo(x,H); }
    for(let y=0;y<=H;y+=step){ ctx.moveTo(0,y); ctx.lineTo(W,y); }
    ctx.stroke();
    ctx.restore();
  }

  // æ¥•å††ï¼ˆè»Œé“ç·šï¼‰æç”»
  function drawOrbit(){
    const {m,cx,cy} = getScaleAndOrigin();
    // æ¥•å††ã®å¹¾ä½•ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    const b = a*Math.sqrt(1-e*e);
    const c = a*e; // ç„¦ç‚¹è·é›¢

    // ã‚¹ã‚¿ã‚¤ãƒ«
    ctx.save();
    ctx.strokeStyle = '#cfd8e3';
    ctx.lineWidth = 2;

    // ãƒ‘ã‚¹ç”Ÿæˆï¼ˆä¸­å¿ƒã¯ç„¦ç‚¹ã‹ã‚‰ +c ã®ä½ç½®ï¼‰
    ctx.beginPath();
    const steps = 240;
    for(let i=0;i<=steps;i++){
      const theta = i/steps * 2*Math.PI;
      // çœŸå††ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ¥•å††å¼ï¼ˆä¸­å¿ƒåŸºæº–ï¼‰
      const px = a*Math.cos(theta); // æ¥•å††ä¸­å¿ƒåŸºæº–
      const py = b*Math.sin(theta);
      const x = cx + (px - c)*m;  // ç„¦ç‚¹ã‚’åŸç‚¹ã«ã™ã‚‹ãŸã‚ä¸­å¿ƒã‚’å·¦ã¸ c
      const y = cy + py*m;
      if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
    }
    ctx.stroke();

    // ç„¦ç‚¹ï¼ˆå¤ªé™½ï¼‰
    ctx.fillStyle = '#f59e0b';
    ctx.beginPath(); ctx.arc(cx, cy, 6, 0, Math.PI*2); ctx.fill();

    ctx.restore();
  }

  // ç­‰é¢ç©ï¼šæ‰‡å½¢ç¾¤æç”»ï¼ˆæ·¡è‰²ï¼‰
  function drawSectors(time){
    if(!ui.showSectors.checked) return;
    const T = period(a);
    const n = meanMotion(a);
    const {cx,cy} = getScaleAndOrigin();

    for(let i=0;i<sectors.length;i++){
      const seg = sectors[i];
      const active = (time % T) >= seg.t0 && (time % T) < seg.t1;

      // t0..t1 ã‚’ç´°åˆ†å‰²ã—ã¦ãƒãƒªã‚´ãƒ³åŒ–
      const pts = [];
      for(let k=0;k<=ARC_STEPS;k++){
        const tt = seg.t0 + (seg.t1-seg.t0)*k/ARC_STEPS;
        const M = n*tt; // è¿‘ç‚¹é€šéã‚’ t=0 ã¨ã™ã‚‹
        const E = solveKepler(M, e);
        const {r, nu} = stateFromE(a,e,E);
        pts.push(toXY(r,nu));
      }
      ctx.save();
      ctx.beginPath();
      ctx.moveTo(cx,cy);
      for(const p of pts){ ctx.lineTo(p.x,p.y); }
      ctx.closePath();
      ctx.fillStyle = active ? 'rgba(126,200,227,0.22)' : 'rgba(126,200,227,0.10)';
      ctx.fill();
      ctx.restore();
    }
  }

  // é¢ç©é€Ÿåº¦ã‚¹ãƒˆãƒªãƒ¼ãƒï¼ˆæ»‘ã‚‰ã‹ãªå¡—ã‚Šï¼‰
  function drawArealStream(time){
    if(!ui.showAreal.checked) return;
    const {cx,cy} = getScaleAndOrigin();
    const n = meanMotion(a);
    const t0 = time - arealWindow;
    const N = AREAL_STEPS;
    // ã‚µãƒ³ãƒ—ãƒ«ç‚¹
    const pts = [];
    for(let s=0; s<=N; s++){
      const tt = t0 + (arealWindow * s / N);
      const M = n*tt;
      const E = solveKepler(M, e);
      const st = stateFromE(a,e,E);
      pts.push(toXY(st.r, st.nu));
    }
    // é€£ç¶šä¸‰è§’å½¢ã§å¡—ã‚‹ï¼ˆå¤ã„ã»ã©è–„ãï¼‰
    for(let s=0; s<N; s++){
      const p0 = pts[s], p1 = pts[s+1];
      const age = s / N; // 0 å¤ â†’ 1 æ–°
      const alpha = 0.06 + 0.22 * (age); // ã ã‚“ã ã‚“æ¿ƒã
      ctx.save();
      ctx.beginPath();
      ctx.moveTo(cx,cy);
      ctx.lineTo(p0.x,p0.y);
      ctx.lineTo(p1.x,p1.y);
      ctx.closePath();
      ctx.fillStyle = `rgba(255,209,102,${alpha})`; // ã‚¢ã‚¯ã‚»ãƒ³ãƒˆé»„
      ctx.fill();
      ctx.restore();
    }
  }

  // æƒ‘æ˜Ÿæç”»ï¼ˆç‚¹æ»…ã®æ—¢å®šå€¤ã¯0ã§OFFï¼‰
  function drawPlanet(time){
    const n = meanMotion(a);
    const M = n*time;
    const E = solveKepler(M, e);
    const st = stateFromE(a,e,E);
    const v = speed(a, st.r);
    const p = toXY(st.r, st.nu);

    // è»Œè·¡
    if(ui.showTrail.checked){
      trail.push(p);
      if(trail.length>TRAIL_MAX) trail.shift();
      ctx.save(); ctx.strokeStyle = 'rgba(15,23,42,0.12)'; ctx.lineWidth=2; ctx.beginPath();
      for(let i=0;i<trail.length;i++){
        const q=trail[i]; if(i===0) ctx.moveTo(q.x,q.y); else ctx.lineTo(q.x,q.y);
      }
      ctx.stroke(); ctx.restore();
    } else { trail.length=0; }

    // ç‚¹æ»…ï¼ˆOFFæ—¢å®šã€å€¤>0ãªã‚‰å¼±ãï¼‰
    const blinkIntensity = parseFloat(ui.blink.value); // 0..2
    const f0 = 0.6; // åŸºæœ¬å‘¨æ³¢æ•°
    const f = f0 + 1.2 * (v/Math.sqrt(MU/a)) * blinkIntensity; // ä»£è¡¨é€Ÿåº¦ã§æ­£è¦åŒ–
    const pulse = blinkIntensity === 0 ? 0 : (0.5 + 0.5*Math.sin(2*Math.PI*f*time));

    // å¤–å´ã®æŸ”ã‚‰ã‹ã„ã‚°ãƒ­ãƒ¼
    ctx.save();
    ctx.beginPath(); ctx.arc(p.x, p.y, 12 + 10*pulse, 0, Math.PI*2);
    ctx.fillStyle = `rgba(255,209,102,${0.12 + 0.18*pulse})`; ctx.fill();

    // æœ¬ä½“
    ctx.beginPath(); ctx.arc(p.x, p.y, 6, 0, Math.PI*2);
    ctx.fillStyle = '#1f7a9a'; ctx.fill();
    ctx.strokeStyle = '#053b53'; ctx.lineWidth = 2; ctx.stroke();

    // HUDï¼ˆé¢ç©é€Ÿåº¦ AË™ = 0.5 * sqrt(mu a (1-e^2))ï¼‰
    const areal = 0.5*Math.sqrt(MU*a*(1-e*e));
    setChip(`a=${a.toFixed(2)}  e=${e.toFixed(2)}  v=${v.toFixed(3)}  AË™=${areal.toFixed(3)}  Tâˆa^{3/2}=${Math.pow(a,1.5).toFixed(2)}ï¼ˆç›¸å¯¾ï¼‰`);

    ctx.restore();
  }

  // 1ãƒ•ãƒ¬ãƒ¼ãƒ æç”»
  function draw(ts){
    if(!lastTs) lastTs = ts;
    const dt = Math.min(0.05, (ts - lastTs)/1000) * parseFloat(ui.speed.value);
    lastTs = ts;
    if(playing) t += dt;

    // ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ã‚¯ãƒªã‚¢
    const W = canvas.clientWidth, H = canvas.clientHeight;
    ctx.clearRect(0,0,W,H);

    drawGrid();
    drawSectors(t);
    drawArealStream(t);
    drawOrbit();
    drawPlanet(t);

    requestAnimationFrame(draw);
  }

  // UI ã‚¤ãƒ™ãƒ³ãƒˆ
  function syncUI(){
    a = parseFloat(ui.a.value); ui.aVal.textContent = a.toFixed(2);
    e = parseFloat(ui.e.value); ui.eVal.textContent = e.toFixed(2);
    ui.speedVal.textContent = parseFloat(ui.speed.value).toFixed(1);
    ui.blinkVal.textContent = parseFloat(ui.blink.value).toFixed(2);
    arealWindow = parseFloat(ui.awindow.value); ui.awVal.textContent = arealWindow.toFixed(1);
    recomputeSectors();
  }
  ['a','e','speed','blink','showSectors','showTrail','showAreal','awindow','toggleGrid'].forEach(id=>{
    ui[id].addEventListener('input', ()=>{ syncUI(); });
    ui[id].addEventListener('change', ()=>{ syncUI(); });
  });

  ui.play.addEventListener('click', ()=>{ playing = true; });
  ui.pause.addEventListener('click', ()=>{ playing = false; });
  ui.reset.addEventListener('click', ()=>{ t = 0; trail.length=0; });
  ui.save.addEventListener('click', ()=>{
    // PNG ä¿å­˜ï¼ˆé«˜DPIã§ã‚‚ç­‰å€ã§ä¿å­˜ï¼‰
    const link = document.createElement('a');
    link.download = `orbital_postcard_a${a.toFixed(2)}_e${e.toFixed(2)}.png`;
    link.href = canvas.toDataURL('image/png');
    link.click();
  });

  // åˆæœŸåŒ–
  function init(){
    resize();
    syncUI();
    playing = true; // ãƒ‡ãƒ¢çš„ã«æœ€åˆã¯å‹•ã‹ã™
    requestAnimationFrame(draw);
  }
  init();
})();
</script>
</body>
</html>