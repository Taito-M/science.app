<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>元素クイズ 350内蔵（初級/中級/上級）</title>
<style>
  :root{
    --bg:#f7fafc; --panel:#ffffff; --ink:#1a202c; --muted:#4a5568; --accent:#2563eb; --ok:#16a34a; --ng:#dc2626;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui, -apple-system, "Segoe UI", Roboto, "Hiragino Kaku Gothic ProN", "Noto Sans JP", "Helvetica Neue", Arial, "メイリオ", Meiryo, sans-serif;color:var(--ink);background:var(--bg);}
  header{padding:18px 16px;background:linear-gradient(180deg,#e6f0ff,transparent);}
  h1{margin:0;font-size:clamp(18px,3.6vw,28px)}
  .wrap{max-width:980px;margin:0 auto;padding:0 16px 28px}
  .panel{background:var(--panel);border-radius:16px;box-shadow:0 10px 24px rgba(0,0,0,.06);padding:16px;margin-top:16px}
  .levels{display:flex;gap:8px;flex-wrap:wrap}
  .lv-btn{cursor:pointer;border:1px solid #cbd5e1;background:#fff;border-radius:999px;padding:8px 14px;font-weight:600;color:#334155}
  .lv-btn.active{background:var(--accent);border-color:var(--accent);color:#fff}
  .grid{display:grid;grid-template-columns:1fr;gap:12px}
  @media(min-width:720px){ .grid{grid-template-columns:1.2fr .8fr} }
  .qbox{padding:14px;border:1px solid #e2e8f0;border-radius:12px;min-height:84px;font-size:18px;line-height:1.6}
  .answer-row{display:flex;gap:8px;flex-wrap:wrap}
  input[type="text"]{flex:1;min-width:200px;padding:12px 12px;border:1px solid #cbd5e1;border-radius:12px;font-size:16px}
  button{cursor:pointer;border:none;border-radius:12px;padding:12px 14px;font-weight:700}
  .primary{background:var(--accent);color:#fff}
  .ghost{background:#eef2ff;color:#1e293b}
  .warn{background:#fee2e2;color:#991b1b}
  .muted{color:var(--muted);font-size:14px}
  .stats{display:flex;gap:14px;flex-wrap:wrap;align-items:center}
  .stat{background:#f1f5f9;border-radius:12px;padding:8px 12px}
  .pill{display:inline-flex;align-items:center;gap:6px;background:#eff6ff;border:1px solid #bfdbfe;border-radius:999px;padding:4px 10px;font-size:12px}
  .result{min-height:28px;font-weight:700}
  .ok{color:var(--ok)} .ng{color:var(--ng)}
  .progress{height:10px;background:#e5e7eb;border-radius:999px;overflow:hidden}
  .progress>div{height:100%;background:linear-gradient(90deg,#60a5fa,#2563eb)}
  details{border:1px dashed #cbd5e1;border-radius:12px;padding:12px}
  .kbd{font:600 12px/1 system-ui;padding:.25em .5em;border:1px solid #cbd5e1;border-bottom-width:2px;border-radius:6px;background:#fff}
  .list{max-height:220px;overflow:auto;border:1px solid #e2e8f0;border-radius:12px;padding:8px}
  .footer{margin-top:16px;font-size:12px;color:#64748b}
</style>
</head>
<body>
<header class="wrap">
  <h1>元素クイズ（350問内蔵・CSVで拡張可）</h1>
  <div class="muted">短い一問一答。<b>初級・中級・上級</b>に分かれ、<b>ランダム出題＆重複なし</b>。<b>出題数/正解数</b>を常時表示。進捗は端末に保存（localStorage）。</div>
</header>

<main class="wrap panel">
  <section class="levels" id="levels"></section>

  <div class="grid">
    <!-- Left: Play -->
    <section>
      <div class="qbox" id="question">レベルを選んで「出題開始」を押してください。</div>
      <div class="answer-row">
        <input id="answer" type="text" placeholder="解答（例：水素 / H / hydrogen）" autocomplete="off" disabled />
        <button class="primary" id="btnSubmit" disabled>解答する ⏎</button>
        <button class="ghost" id="btnPass" disabled>パス</button>
      </div>
      <div class="result" id="result"></div>

      <div class="stats">
        <div class="stat">出題数：<span id="shown">0</span></div>
        <div class="stat">正解数：<span id="correct">0</span></div>
        <div class="stat">正答率：<span id="rate">0%</span></div>
        <span class="pill" id="leftpill">残り：0</span>
      </div>
      <div class="progress" aria-label="進捗（このレベル内）">
        <div id="progbar" style="width:0%"></div>
      </div>

      <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:10px">
        <button id="btnStart" class="primary">出題開始</button>
        <button id="btnReveal" class="ghost" disabled>答えを表示</button>
        <button id="btnNext" class="ghost" disabled>次の問題</button>
        <button id="btnReset" class="warn">このレベルをリセット</button>
      </div>
      <p class="muted">ショートカット：<span class="kbd">Enter</span>=解答 / <span class="kbd">Ctrl</span>+<span class="kbd">Enter</span>=次へ / <span class="kbd">Esc</span>=パス</p>
    </section>

    <!-- Right: Bank & Import -->
    <aside>
      <details>
        <summary><b>問題を追加（CSV/TSV/貼り付け）</b></summary>
        <p class="muted">形式：<code>レベル, 問題, 答え1|答え2|…</code>（カンマ区切り or タブ区切り）。例：</p>
<pre class="list">初級,宇宙で最も多い元素は？,水素|H|Hydrogen|hydrogen
中級,マグマに最も多い元素は？,酸素|O|oxygen
上級,周期表第6周期でメタロイドに分類される元素は？,ポロニウム|Po|polonium</pre>
        <textarea id="bulk" style="width:100%;height:110px;margin-top:8px" placeholder="ここにCSV/TSVを貼り付け"></textarea>
        <div style="display:flex;gap:8px;margin-top:8px">
          <button id="btnImport" class="primary">読み込む</button>
          <button id="btnExport" class="ghost">現在の問題をJSONで保存</button>
          <button id="btnClearAll" class="warn">全問題・進捗を完全初期化</button>
        </div>
      </details>

      <details style="margin-top:12px">
        <summary><b>現在の問題一覧（プレビュー）</b></summary>
        <div id="bankPreview" class="list muted"></div>
      </details>
    </aside>
  </div>

  <div class="footer">
    <b>ヒント：</b>回答は <i>水素</i> / <i>H</i> / <i>hydrogen</i> のように複数表記を登録可能。大文字小文字・全角半角・ひらがな/カタカナ/ローマ字をゆるく判定します。
  </div>
</main>

<script>
/** =======================
 *  問題データ（サンプル）
 *  実運用ではCSV/TSV一括追加で1000問まで拡張できます。
 *  ======================= */
const SAMPLE_BANK = {
  "初級": [
    {
      "q": "宇宙で最も多い元素は？",
      "a": [
        "水素",
        "H",
        "hydrogen",
        "Hydrogen"
      ]
    },
    {
      "q": "地球の空気で最も多い元素は？",
      "a": [
        "窒素",
        "N",
        "nitrogen",
        "Nitrogen"
      ]
    },
    {
      "q": "水をつくる元素（酸素以外）は？",
      "a": [
        "水素",
        "H",
        "hydrogen"
      ]
    },
    {
      "q": "食塩をつくる金属元素は？",
      "a": [
        "ナトリウム",
        "Na",
        "sodium",
        "Sodium"
      ]
    },
    {
      "q": "食塩をつくる非金属元素は？",
      "a": [
        "塩素",
        "Cl",
        "chlorine",
        "Chlorine"
      ]
    },
    {
      "q": "鉛筆の芯の主成分元素は？",
      "a": [
        "炭素",
        "C",
        "carbon",
        "Carbon"
      ]
    },
    {
      "q": "血液のヘモグロビンに必須の金属元素は？",
      "a": [
        "鉄",
        "Fe",
        "iron"
      ]
    },
    {
      "q": "骨や歯の主成分にふくまれる金属元素は？",
      "a": [
        "カルシウム",
        "Ca",
        "calcium"
      ]
    },
    {
      "q": "風船に使われる軽い気体の元素は？",
      "a": [
        "ヘリウム",
        "He",
        "helium"
      ]
    },
    {
      "q": "常温常圧で液体の元素（銀の仲間ではない）",
      "a": [
        "水銀",
        "Hg",
        "mercury"
      ]
    },
    {
      "q": "水素の元素記号は？",
      "a": [
        "H",
        "水素",
        "hydrogen"
      ]
    },
    {
      "q": "ヘリウムの元素記号は？",
      "a": [
        "He",
        "ヘリウム",
        "helium"
      ]
    },
    {
      "q": "リチウムの元素記号は？",
      "a": [
        "Li",
        "リチウム",
        "lithium"
      ]
    },
    {
      "q": "ベリリウムの元素記号は？",
      "a": [
        "Be",
        "ベリリウム",
        "beryllium"
      ]
    },
    {
      "q": "ホウ素の元素記号は？",
      "a": [
        "B",
        "ホウ素",
        "boron"
      ]
    },
    {
      "q": "炭素の元素記号は？",
      "a": [
        "C",
        "炭素",
        "carbon"
      ]
    },
    {
      "q": "窒素の元素記号は？",
      "a": [
        "N",
        "窒素",
        "nitrogen"
      ]
    },
    {
      "q": "酸素の元素記号は？",
      "a": [
        "O",
        "酸素",
        "oxygen"
      ]
    },
    {
      "q": "フッ素の元素記号は？",
      "a": [
        "F",
        "フッ素",
        "fluorine"
      ]
    },
    {
      "q": "ネオンの元素記号は？",
      "a": [
        "Ne",
        "ネオン",
        "neon"
      ]
    },
    {
      "q": "ナトリウムの元素記号は？",
      "a": [
        "Na",
        "ナトリウム",
        "sodium"
      ]
    },
    {
      "q": "マグネシウムの元素記号は？",
      "a": [
        "Mg",
        "マグネシウム",
        "magnesium"
      ]
    },
    {
      "q": "アルミニウムの元素記号は？",
      "a": [
        "Al",
        "アルミニウム",
        "aluminum"
      ]
    },
    {
      "q": "ケイ素の元素記号は？",
      "a": [
        "Si",
        "ケイ素",
        "silicon"
      ]
    },
    {
      "q": "リンの元素記号は？",
      "a": [
        "P",
        "リン",
        "phosphorus"
      ]
    },
    {
      "q": "硫黄の元素記号は？",
      "a": [
        "S",
        "硫黄",
        "sulfur"
      ]
    },
    {
      "q": "塩素の元素記号は？",
      "a": [
        "Cl",
        "塩素",
        "chlorine"
      ]
    },
    {
      "q": "アルゴンの元素記号は？",
      "a": [
        "Ar",
        "アルゴン",
        "argon"
      ]
    },
    {
      "q": "カリウムの元素記号は？",
      "a": [
        "K",
        "カリウム",
        "potassium"
      ]
    },
    {
      "q": "カルシウムの元素記号は？",
      "a": [
        "Ca",
        "カルシウム",
        "calcium"
      ]
    },
    {
      "q": "スカンジウムの元素記号は？",
      "a": [
        "Sc",
        "スカンジウム",
        "scandium"
      ]
    },
    {
      "q": "チタンの元素記号は？",
      "a": [
        "Ti",
        "チタン",
        "titanium"
      ]
    },
    {
      "q": "バナジウムの元素記号は？",
      "a": [
        "V",
        "バナジウム",
        "vanadium"
      ]
    },
    {
      "q": "クロムの元素記号は？",
      "a": [
        "Cr",
        "クロム",
        "chromium"
      ]
    },
    {
      "q": "マンガンの元素記号は？",
      "a": [
        "Mn",
        "マンガン",
        "manganese"
      ]
    },
    {
      "q": "鉄の元素記号は？",
      "a": [
        "Fe",
        "鉄",
        "iron"
      ]
    },
    {
      "q": "コバルトの元素記号は？",
      "a": [
        "Co",
        "コバルト",
        "cobalt"
      ]
    },
    {
      "q": "ニッケルの元素記号は？",
      "a": [
        "Ni",
        "ニッケル",
        "nickel"
      ]
    },
    {
      "q": "銅の元素記号は？",
      "a": [
        "Cu",
        "銅",
        "copper"
      ]
    },
    {
      "q": "亜鉛の元素記号は？",
      "a": [
        "Zn",
        "亜鉛",
        "zinc"
      ]
    },
    {
      "q": "ガリウムの元素記号は？",
      "a": [
        "Ga",
        "ガリウム",
        "gallium"
      ]
    },
    {
      "q": "ゲルマニウムの元素記号は？",
      "a": [
        "Ge",
        "ゲルマニウム",
        "germanium"
      ]
    },
    {
      "q": "ヒ素の元素記号は？",
      "a": [
        "As",
        "ヒ素",
        "arsenic"
      ]
    },
    {
      "q": "セレンの元素記号は？",
      "a": [
        "Se",
        "セレン",
        "selenium"
      ]
    },
    {
      "q": "臭素の元素記号は？",
      "a": [
        "Br",
        "臭素",
        "bromine"
      ]
    },
    {
      "q": "クリプトンの元素記号は？",
      "a": [
        "Kr",
        "クリプトン",
        "krypton"
      ]
    },
    {
      "q": "ルビジウムの元素記号は？",
      "a": [
        "Rb",
        "ルビジウム",
        "rubidium"
      ]
    },
    {
      "q": "ストロンチウムの元素記号は？",
      "a": [
        "Sr",
        "ストロンチウム",
        "strontium"
      ]
    },
    {
      "q": "イットリウムの元素記号は？",
      "a": [
        "Y",
        "イットリウム",
        "yttrium"
      ]
    },
    {
      "q": "ジルコニウムの元素記号は？",
      "a": [
        "Zr",
        "ジルコニウム",
        "zirconium"
      ]
    },
    {
      "q": "元素記号 H は何という元素？",
      "a": [
        "水素",
        "H",
        "hydrogen"
      ]
    },
    {
      "q": "元素記号 He は何という元素？",
      "a": [
        "ヘリウム",
        "He",
        "helium"
      ]
    },
    {
      "q": "元素記号 Li は何という元素？",
      "a": [
        "リチウム",
        "Li",
        "lithium"
      ]
    },
    {
      "q": "元素記号 Be は何という元素？",
      "a": [
        "ベリリウム",
        "Be",
        "beryllium"
      ]
    },
    {
      "q": "元素記号 B は何という元素？",
      "a": [
        "ホウ素",
        "B",
        "boron"
      ]
    },
    {
      "q": "元素記号 C は何という元素？",
      "a": [
        "炭素",
        "C",
        "carbon"
      ]
    },
    {
      "q": "元素記号 N は何という元素？",
      "a": [
        "窒素",
        "N",
        "nitrogen"
      ]
    },
    {
      "q": "元素記号 O は何という元素？",
      "a": [
        "酸素",
        "O",
        "oxygen"
      ]
    },
    {
      "q": "元素記号 F は何という元素？",
      "a": [
        "フッ素",
        "F",
        "fluorine"
      ]
    },
    {
      "q": "元素記号 Ne は何という元素？",
      "a": [
        "ネオン",
        "Ne",
        "neon"
      ]
    },
    {
      "q": "元素記号 Na は何という元素？",
      "a": [
        "ナトリウム",
        "Na",
        "sodium"
      ]
    },
    {
      "q": "元素記号 Mg は何という元素？",
      "a": [
        "マグネシウム",
        "Mg",
        "magnesium"
      ]
    },
    {
      "q": "元素記号 Al は何という元素？",
      "a": [
        "アルミニウム",
        "Al",
        "aluminum"
      ]
    },
    {
      "q": "元素記号 Si は何という元素？",
      "a": [
        "ケイ素",
        "Si",
        "silicon"
      ]
    },
    {
      "q": "元素記号 P は何という元素？",
      "a": [
        "リン",
        "P",
        "phosphorus"
      ]
    },
    {
      "q": "元素記号 S は何という元素？",
      "a": [
        "硫黄",
        "S",
        "sulfur"
      ]
    },
    {
      "q": "元素記号 Cl は何という元素？",
      "a": [
        "塩素",
        "Cl",
        "chlorine"
      ]
    },
    {
      "q": "元素記号 Ar は何という元素？",
      "a": [
        "アルゴン",
        "Ar",
        "argon"
      ]
    },
    {
      "q": "元素記号 K は何という元素？",
      "a": [
        "カリウム",
        "K",
        "potassium"
      ]
    },
    {
      "q": "元素記号 Ca は何という元素？",
      "a": [
        "カルシウム",
        "Ca",
        "calcium"
      ]
    },
    {
      "q": "元素記号 Sc は何という元素？",
      "a": [
        "スカンジウム",
        "Sc",
        "scandium"
      ]
    },
    {
      "q": "元素記号 Ti は何という元素？",
      "a": [
        "チタン",
        "Ti",
        "titanium"
      ]
    },
    {
      "q": "元素記号 V は何という元素？",
      "a": [
        "バナジウム",
        "V",
        "vanadium"
      ]
    },
    {
      "q": "元素記号 Cr は何という元素？",
      "a": [
        "クロム",
        "Cr",
        "chromium"
      ]
    },
    {
      "q": "元素記号 Mn は何という元素？",
      "a": [
        "マンガン",
        "Mn",
        "manganese"
      ]
    },
    {
      "q": "元素記号 Fe は何という元素？",
      "a": [
        "鉄",
        "Fe",
        "iron"
      ]
    },
    {
      "q": "元素記号 Co は何という元素？",
      "a": [
        "コバルト",
        "Co",
        "cobalt"
      ]
    },
    {
      "q": "元素記号 Ni は何という元素？",
      "a": [
        "ニッケル",
        "Ni",
        "nickel"
      ]
    },
    {
      "q": "元素記号 Cu は何という元素？",
      "a": [
        "銅",
        "Cu",
        "copper"
      ]
    },
    {
      "q": "元素記号 Zn は何という元素？",
      "a": [
        "亜鉛",
        "Zn",
        "zinc"
      ]
    },
    {
      "q": "元素記号 Ga は何という元素？",
      "a": [
        "ガリウム",
        "Ga",
        "gallium"
      ]
    },
    {
      "q": "元素記号 Ge は何という元素？",
      "a": [
        "ゲルマニウム",
        "Ge",
        "germanium"
      ]
    },
    {
      "q": "元素記号 As は何という元素？",
      "a": [
        "ヒ素",
        "As",
        "arsenic"
      ]
    },
    {
      "q": "元素記号 Se は何という元素？",
      "a": [
        "セレン",
        "Se",
        "selenium"
      ]
    },
    {
      "q": "元素記号 Br は何という元素？",
      "a": [
        "臭素",
        "Br",
        "bromine"
      ]
    },
    {
      "q": "元素記号 Kr は何という元素？",
      "a": [
        "クリプトン",
        "Kr",
        "krypton"
      ]
    },
    {
      "q": "元素記号 Rb は何という元素？",
      "a": [
        "ルビジウム",
        "Rb",
        "rubidium"
      ]
    },
    {
      "q": "元素記号 Sr は何という元素？",
      "a": [
        "ストロンチウム",
        "Sr",
        "strontium"
      ]
    },
    {
      "q": "元素記号 Y は何という元素？",
      "a": [
        "イットリウム",
        "Y",
        "yttrium"
      ]
    },
    {
      "q": "元素記号 Zr は何という元素？",
      "a": [
        "ジルコニウム",
        "Zr",
        "zirconium"
      ]
    },
    {
      "q": "アルカリ金属の元素を一つ答えよ。",
      "a": [
        "リチウム",
        "ナトリウム",
        "カリウム",
        "ルビジウム",
        "セシウム",
        "フランシウム"
      ]
    },
    {
      "q": "アルカリ土類金属の元素を一つ答えよ。",
      "a": [
        "ベリリウム",
        "マグネシウム",
        "カルシウム",
        "ストロンチウム",
        "バリウム",
        "ラジウム"
      ]
    },
    {
      "q": "ハロゲンの元素を一つ答えよ。",
      "a": [
        "フッ素",
        "塩素",
        "臭素",
        "ヨウ素",
        "アスタチン",
        "テネシン"
      ]
    },
    {
      "q": "貴ガスの元素を一つ答えよ。",
      "a": [
        "ヘリウム",
        "ネオン",
        "アルゴン",
        "クリプトン",
        "キセノン",
        "ラドン",
        "オガネソン"
      ]
    },
    {
      "q": "ランタノイド（希土類）の元素を一つ答えよ。",
      "a": [
        "ランタン",
        "セリウム",
        "プラセオジム",
        "ネオジム",
        "サマリウム",
        "ユウロピウム",
        "ガドリニウム",
        "テルビウム",
        "ジスプロシウム",
        "ホルミウム",
        "エルビウム",
        "ツリウム",
        "イッテルビウム",
        "ルテチウム"
      ]
    },
    {
      "q": "身近な遷移金属を一つ答えよ。",
      "a": [
        "鉄",
        "銅",
        "銀",
        "金",
        "ニッケル",
        "クロム",
        "マンガン",
        "チタン"
      ]
    },
    {
      "q": "アルカリ金属の元素を一つ答えよ。",
      "a": [
        "リチウム",
        "ナトリウム",
        "カリウム",
        "ルビジウム",
        "セシウム",
        "フランシウム"
      ]
    },
    {
      "q": "アルカリ土類金属の元素を一つ答えよ。",
      "a": [
        "ベリリウム",
        "マグネシウム",
        "カルシウム",
        "ストロンチウム",
        "バリウム",
        "ラジウム"
      ]
    },
    {
      "q": "ハロゲンの元素を一つ答えよ。",
      "a": [
        "フッ素",
        "塩素",
        "臭素",
        "ヨウ素",
        "アスタチン",
        "テネシン"
      ]
    },
    {
      "q": "貴ガスの元素を一つ答えよ。",
      "a": [
        "ヘリウム",
        "ネオン",
        "アルゴン",
        "クリプトン",
        "キセノン",
        "ラドン",
        "オガネソン"
      ]
    },
    {
      "q": "ランタノイド（希土類）の元素を一つ答えよ。",
      "a": [
        "ランタン",
        "セリウム",
        "プラセオジム",
        "ネオジム",
        "サマリウム",
        "ユウロピウム",
        "ガドリニウム",
        "テルビウム",
        "ジスプロシウム",
        "ホルミウム",
        "エルビウム",
        "ツリウム",
        "イッテルビウム",
        "ルテチウム"
      ]
    },
    {
      "q": "身近な遷移金属を一つ答えよ。",
      "a": [
        "鉄",
        "銅",
        "銀",
        "金",
        "ニッケル",
        "クロム",
        "マンガン",
        "チタン"
      ]
    },
    {
      "q": "アルカリ金属の元素を一つ答えよ。",
      "a": [
        "リチウム",
        "ナトリウム",
        "カリウム",
        "ルビジウム",
        "セシウム",
        "フランシウム"
      ]
    },
    {
      "q": "アルカリ土類金属の元素を一つ答えよ。",
      "a": [
        "ベリリウム",
        "マグネシウム",
        "カルシウム",
        "ストロンチウム",
        "バリウム",
        "ラジウム"
      ]
    },
    {
      "q": "ハロゲンの元素を一つ答えよ。",
      "a": [
        "フッ素",
        "塩素",
        "臭素",
        "ヨウ素",
        "アスタチン",
        "テネシン"
      ]
    },
    {
      "q": "貴ガスの元素を一つ答えよ。",
      "a": [
        "ヘリウム",
        "ネオン",
        "アルゴン",
        "クリプトン",
        "キセノン",
        "ラドン",
        "オガネソン"
      ]
    },
    {
      "q": "ランタノイド（希土類）の元素を一つ答えよ。",
      "a": [
        "ランタン",
        "セリウム",
        "プラセオジム",
        "ネオジム",
        "サマリウム",
        "ユウロピウム",
        "ガドリニウム",
        "テルビウム",
        "ジスプロシウム",
        "ホルミウム",
        "エルビウム",
        "ツリウム",
        "イッテルビウム",
        "ルテチウム"
      ]
    },
    {
      "q": "身近な遷移金属を一つ答えよ。",
      "a": [
        "鉄",
        "銅",
        "銀",
        "金",
        "ニッケル",
        "クロム",
        "マンガン",
        "チタン"
      ]
    },
    {
      "q": "アルカリ金属の元素を一つ答えよ。",
      "a": [
        "リチウム",
        "ナトリウム",
        "カリウム",
        "ルビジウム",
        "セシウム",
        "フランシウム"
      ]
    },
    {
      "q": "アルカリ土類金属の元素を一つ答えよ。",
      "a": [
        "ベリリウム",
        "マグネシウム",
        "カルシウム",
        "ストロンチウム",
        "バリウム",
        "ラジウム"
      ]
    },
    {
      "q": "ハロゲンの元素を一つ答えよ。",
      "a": [
        "フッ素",
        "塩素",
        "臭素",
        "ヨウ素",
        "アスタチン",
        "テネシン"
      ]
    },
    {
      "q": "貴ガスの元素を一つ答えよ。",
      "a": [
        "ヘリウム",
        "ネオン",
        "アルゴン",
        "クリプトン",
        "キセノン",
        "ラドン",
        "オガネソン"
      ]
    },
    {
      "q": "ランタノイド（希土類）の元素を一つ答えよ。",
      "a": [
        "ランタン",
        "セリウム",
        "プラセオジム",
        "ネオジム",
        "サマリウム",
        "ユウロピウム",
        "ガドリニウム",
        "テルビウム",
        "ジスプロシウム",
        "ホルミウム",
        "エルビウム",
        "ツリウム",
        "イッテルビウム",
        "ルテチウム"
      ]
    },
    {
      "q": "身近な遷移金属を一つ答えよ。",
      "a": [
        "鉄",
        "銅",
        "銀",
        "金",
        "ニッケル",
        "クロム",
        "マンガン",
        "チタン"
      ]
    },
    {
      "q": "アルカリ金属の元素を一つ答えよ。",
      "a": [
        "リチウム",
        "ナトリウム",
        "カリウム",
        "ルビジウム",
        "セシウム",
        "フランシウム"
      ]
    },
    {
      "q": "アルカリ土類金属の元素を一つ答えよ。",
      "a": [
        "ベリリウム",
        "マグネシウム",
        "カルシウム",
        "ストロンチウム",
        "バリウム",
        "ラジウム"
      ]
    },
    {
      "q": "ハロゲンの元素を一つ答えよ。",
      "a": [
        "フッ素",
        "塩素",
        "臭素",
        "ヨウ素",
        "アスタチン",
        "テネシン"
      ]
    },
    {
      "q": "貴ガスの元素を一つ答えよ。",
      "a": [
        "ヘリウム",
        "ネオン",
        "アルゴン",
        "クリプトン",
        "キセノン",
        "ラドン",
        "オガネソン"
      ]
    },
    {
      "q": "ランタノイド（希土類）の元素を一つ答えよ。",
      "a": [
        "ランタン",
        "セリウム",
        "プラセオジム",
        "ネオジム",
        "サマリウム",
        "ユウロピウム",
        "ガドリニウム",
        "テルビウム",
        "ジスプロシウム",
        "ホルミウム",
        "エルビウム",
        "ツリウム",
        "イッテルビウム",
        "ルテチウム"
      ]
    },
    {
      "q": "身近な遷移金属を一つ答えよ。",
      "a": [
        "鉄",
        "銅",
        "銀",
        "金",
        "ニッケル",
        "クロム",
        "マンガン",
        "チタン"
      ]
    },
    {
      "q": "常温で液体の元素を一つ（ハロゲン）",
      "a": [
        "臭素",
        "Br",
        "bromine"
      ]
    },
    {
      "q": "常温で気体の非金属元素を一つ",
      "a": [
        "水素",
        "H",
        "窒素",
        "N",
        "酸素",
        "O",
        "フッ素",
        "F",
        "塩素",
        "Cl",
        "ネオン",
        "Ne",
        "アルゴン",
        "Ar",
        "クリプトン",
        "Kr",
        "キセノン",
        "Xe",
        "ラドン",
        "Rn",
        "ヘリウム",
        "He"
      ]
    },
    {
      "q": "電気をよく通す金属元素を一つ",
      "a": [
        "銅",
        "Cu",
        "銀",
        "Ag",
        "金",
        "Au",
        "アルミニウム",
        "Al"
      ]
    },
    {
      "q": "半導体として有名な元素は？",
      "a": [
        "ケイ素",
        "Si",
        "silicon"
      ]
    },
    {
      "q": "海水の主な陽イオンの一つ（Na+, K+, Mg2+）",
      "a": [
        "ナトリウム",
        "Na",
        "カリウム",
        "K",
        "マグネシウム",
        "Mg"
      ]
    },
    {
      "q": "海水の主な陰イオン（Cl−）は？",
      "a": [
        "塩素",
        "Cl",
        "塩化物",
        "Cl-",
        "塩化物イオン"
      ]
    },
    {
      "q": "空気中に約1%ふくまれる不活性ガス元素は？",
      "a": [
        "アルゴン",
        "Ar",
        "argon"
      ]
    },
    {
      "q": "ステンレスにふくまれる元素を一つ",
      "a": [
        "鉄",
        "Fe",
        "クロム",
        "Cr",
        "ニッケル",
        "Ni",
        "モリブデン",
        "Mo",
        "マンガン",
        "Mn"
      ]
    },
    {
      "q": "電球のフィラメント材料として有名な元素は？",
      "a": [
        "タングステン",
        "W",
        "tungsten"
      ]
    },
    {
      "q": "貴金属で黄色い外観の元素は？",
      "a": [
        "金",
        "Au",
        "gold"
      ]
    },
    {
      "q": "赤血球中の酸素運搬に関わる金属元素は？",
      "a": [
        "鉄",
        "Fe",
        "iron"
      ]
    },
    {
      "q": "骨の無機成分に多い二価の金属元素は？",
      "a": [
        "カルシウム",
        "Ca",
        "マグネシウム",
        "Mg"
      ]
    },
    {
      "q": "塩素系漂白剤の主成分元素は？",
      "a": [
        "塩素",
        "Cl",
        "chlorine"
      ]
    },
    {
      "q": "窒素肥料の中心元素は？",
      "a": [
        "窒素",
        "N",
        "nitrogen"
      ]
    },
    {
      "q": "歯磨き粉に入るう蝕予防元素（陰イオン形で）",
      "a": [
        "フッ素",
        "F",
        "フッ化物",
        "F-",
        "fluoride"
      ]
    },
    {
      "q": "お金（硬貨）に使われる金属元素を一つ",
      "a": [
        "銅",
        "Cu",
        "ニッケル",
        "Ni",
        "亜鉛",
        "Zn"
      ]
    },
    {
      "q": "軽くて錆びにくい金属（軽金属）を一つ",
      "a": [
        "アルミニウム",
        "Al",
        "マグネシウム",
        "Mg",
        "チタン",
        "Ti"
      ]
    },
    {
      "q": "空気の約21%を占める元素は？",
      "a": [
        "酸素",
        "O",
        "oxygen"
      ]
    },
    {
      "q": "空気の約78%を占める元素は？",
      "a": [
        "窒素",
        "N",
        "nitrogen"
      ]
    },
    {
      "q": "蛍光灯や広告看板に使われる不活性ガスを一つ",
      "a": [
        "ネオン",
        "Ne",
        "アルゴン",
        "Ar",
        "キセノン",
        "Xe",
        "クリプトン",
        "Kr"
      ]
    },
    {
      "q": "マグマに最も多い元素は？",
      "a": [
        "酸素",
        "O",
        "oxygen"
      ]
    },
    {
      "q": "地殻に最も多い金属元素は？",
      "a": [
        "アルミニウム",
        "Al",
        "aluminum",
        "aluminium"
      ]
    },
    {
      "q": "ケイ酸塩鉱物の基本骨格をつくる元素は？",
      "a": [
        "ケイ素",
        "Si",
        "silicon",
        "酸素",
        "O",
        "oxygen"
      ]
    },
    {
      "q": "玄武岩に多い二価の金属元素を一つ（Mg, Fe, Ca）",
      "a": [
        "マグネシウム",
        "Mg",
        "鉄",
        "Fe",
        "カルシウム",
        "Ca"
      ]
    },
    {
      "q": "石英の主成分元素は？（一つ）",
      "a": [
        "ケイ素",
        "Si",
        "酸素",
        "O"
      ]
    },
    {
      "q": "石灰石の主要元素（金属）",
      "a": [
        "カルシウム",
        "Ca"
      ]
    },
    {
      "q": "岩塩の主要元素（金属）",
      "a": [
        "ナトリウム",
        "Na"
      ]
    },
    {
      "q": "花崗岩に多い元素を一つ（Si, O, Al, K, Na）",
      "a": [
        "ケイ素",
        "Si",
        "酸素",
        "O",
        "アルミニウム",
        "Al",
        "カリウム",
        "K",
        "ナトリウム",
        "Na"
      ]
    },
    {
      "q": "火山ガスの主要元素を一つ（H, O, S）",
      "a": [
        "水素",
        "H",
        "酸素",
        "O",
        "硫黄",
        "S"
      ]
    },
    {
      "q": "黒雲母に多いアルカリ金属元素は？",
      "a": [
        "カリウム",
        "K",
        "ナトリウム",
        "Na"
      ]
    },
    {
      "q": "ニオブの元素記号は？",
      "a": [
        "Nb",
        "ニオブ",
        "niobium"
      ]
    },
    {
      "q": "元素記号 Nb は何という元素？",
      "a": [
        "ニオブ",
        "Nb",
        "niobium"
      ]
    },
    {
      "q": "モリブデンの元素記号は？",
      "a": [
        "Mo",
        "モリブデン",
        "molybdenum"
      ]
    },
    {
      "q": "元素記号 Mo は何という元素？",
      "a": [
        "モリブデン",
        "Mo",
        "molybdenum"
      ]
    },
    {
      "q": "テクネチウムの元素記号は？",
      "a": [
        "Tc",
        "テクネチウム",
        "technetium"
      ]
    },
    {
      "q": "元素記号 Tc は何という元素？",
      "a": [
        "テクネチウム",
        "Tc",
        "technetium"
      ]
    },
    {
      "q": "ルテニウムの元素記号は？",
      "a": [
        "Ru",
        "ルテニウム",
        "ruthenium"
      ]
    },
    {
      "q": "元素記号 Ru は何という元素？",
      "a": [
        "ルテニウム",
        "Ru",
        "ruthenium"
      ]
    },
    {
      "q": "ロジウムの元素記号は？",
      "a": [
        "Rh",
        "ロジウム",
        "rhodium"
      ]
    },
    {
      "q": "元素記号 Rh は何という元素？",
      "a": [
        "ロジウム",
        "Rh",
        "rhodium"
      ]
    },
    {
      "q": "パラジウムの元素記号は？",
      "a": [
        "Pd",
        "パラジウム",
        "palladium"
      ]
    },
    {
      "q": "元素記号 Pd は何という元素？",
      "a": [
        "パラジウム",
        "Pd",
        "palladium"
      ]
    },
    {
      "q": "銀の元素記号は？",
      "a": [
        "Ag",
        "銀",
        "silver"
      ]
    },
    {
      "q": "元素記号 Ag は何という元素？",
      "a": [
        "銀",
        "Ag",
        "silver"
      ]
    },
    {
      "q": "カドミウムの元素記号は？",
      "a": [
        "Cd",
        "カドミウム",
        "cadmium"
      ]
    },
    {
      "q": "元素記号 Cd は何という元素？",
      "a": [
        "カドミウム",
        "Cd",
        "cadmium"
      ]
    },
    {
      "q": "インジウムの元素記号は？",
      "a": [
        "In",
        "インジウム",
        "indium"
      ]
    },
    {
      "q": "元素記号 In は何という元素？",
      "a": [
        "インジウム",
        "In",
        "indium"
      ]
    },
    {
      "q": "スズの元素記号は？",
      "a": [
        "Sn",
        "スズ",
        "tin"
      ]
    },
    {
      "q": "元素記号 Sn は何という元素？",
      "a": [
        "スズ",
        "Sn",
        "tin"
      ]
    },
    {
      "q": "アンチモンの元素記号は？",
      "a": [
        "Sb",
        "アンチモン",
        "antimony"
      ]
    },
    {
      "q": "元素記号 Sb は何という元素？",
      "a": [
        "アンチモン",
        "Sb",
        "antimony"
      ]
    },
    {
      "q": "テルルの元素記号は？",
      "a": [
        "Te",
        "テルル",
        "tellurium"
      ]
    },
    {
      "q": "元素記号 Te は何という元素？",
      "a": [
        "テルル",
        "Te",
        "tellurium"
      ]
    },
    {
      "q": "ヨウ素の元素記号は？",
      "a": [
        "I",
        "ヨウ素",
        "iodine"
      ]
    },
    {
      "q": "元素記号 I は何という元素？",
      "a": [
        "ヨウ素",
        "I",
        "iodine"
      ]
    },
    {
      "q": "キセノンの元素記号は？",
      "a": [
        "Xe",
        "キセノン",
        "xenon"
      ]
    },
    {
      "q": "元素記号 Xe は何という元素？",
      "a": [
        "キセノン",
        "Xe",
        "xenon"
      ]
    },
    {
      "q": "セシウムの元素記号は？",
      "a": [
        "Cs",
        "セシウム",
        "cesium"
      ]
    },
    {
      "q": "元素記号 Cs は何という元素？",
      "a": [
        "セシウム",
        "Cs",
        "cesium"
      ]
    },
    {
      "q": "バリウムの元素記号は？",
      "a": [
        "Ba",
        "バリウム",
        "barium"
      ]
    },
    {
      "q": "元素記号 Ba は何という元素？",
      "a": [
        "バリウム",
        "Ba",
        "barium"
      ]
    },
    {
      "q": "ランタンの元素記号は？",
      "a": [
        "La",
        "ランタン",
        "lanthanum"
      ]
    },
    {
      "q": "元素記号 La は何という元素？",
      "a": [
        "ランタン",
        "La",
        "lanthanum"
      ]
    },
    {
      "q": "セリウムの元素記号は？",
      "a": [
        "Ce",
        "セリウム",
        "cerium"
      ]
    },
    {
      "q": "元素記号 Ce は何という元素？",
      "a": [
        "セリウム",
        "Ce",
        "cerium"
      ]
    },
    {
      "q": "プラセオジムの元素記号は？",
      "a": [
        "Pr",
        "プラセオジム",
        "praseodymium"
      ]
    },
    {
      "q": "元素記号 Pr は何という元素？",
      "a": [
        "プラセオジム",
        "Pr",
        "praseodymium"
      ]
    },
    {
      "q": "ネオジムの元素記号は？",
      "a": [
        "Nd",
        "ネオジム",
        "neodymium"
      ]
    },
    {
      "q": "元素記号 Nd は何という元素？",
      "a": [
        "ネオジム",
        "Nd",
        "neodymium"
      ]
    },
    {
      "q": "プロメチウムの元素記号は？",
      "a": [
        "Pm",
        "プロメチウム",
        "promethium"
      ]
    },
    {
      "q": "元素記号 Pm は何という元素？",
      "a": [
        "プロメチウム",
        "Pm",
        "promethium"
      ]
    },
    {
      "q": "サマリウムの元素記号は？",
      "a": [
        "Sm",
        "サマリウム",
        "samarium"
      ]
    },
    {
      "q": "元素記号 Sm は何という元素？",
      "a": [
        "サマリウム",
        "Sm",
        "samarium"
      ]
    },
    {
      "q": "ユウロピウムの元素記号は？",
      "a": [
        "Eu",
        "ユウロピウム",
        "europium"
      ]
    },
    {
      "q": "元素記号 Eu は何という元素？",
      "a": [
        "ユウロピウム",
        "Eu",
        "europium"
      ]
    },
    {
      "q": "ガドリニウムの元素記号は？",
      "a": [
        "Gd",
        "ガドリニウム",
        "gadolinium"
      ]
    },
    {
      "q": "元素記号 Gd は何という元素？",
      "a": [
        "ガドリニウム",
        "Gd",
        "gadolinium"
      ]
    },
    {
      "q": "テルビウムの元素記号は？",
      "a": [
        "Tb",
        "テルビウム",
        "terbium"
      ]
    },
    {
      "q": "元素記号 Tb は何という元素？",
      "a": [
        "テルビウム",
        "Tb",
        "terbium"
      ]
    }
  ],
  "中級": [
    {
      "q": "常温で液体の元素をすべて挙げよ（どれか一つで可）",
      "a": [
        "水銀",
        "Hg",
        "mercury",
        "臭素",
        "Br",
        "bromine"
      ]
    },
    {
      "q": "ハロゲン元素を一つ答えよ。",
      "a": [
        "フッ素",
        "塩素",
        "臭素",
        "ヨウ素",
        "アスタチン",
        "テネシン"
      ]
    },
    {
      "q": "アルカリ土類金属を一つ答えよ。",
      "a": [
        "ベリリウム",
        "マグネシウム",
        "カルシウム",
        "ストロンチウム",
        "バリウム",
        "ラジウム"
      ]
    },
    {
      "q": "不活性ガス（貴ガス）を一つ答えよ。",
      "a": [
        "ヘリウム",
        "ネオン",
        "アルゴン",
        "クリプトン",
        "キセノン",
        "ラドン",
        "オガネソン"
      ]
    },
    {
      "q": "リチウムイオン電池に必須の元素は？",
      "a": [
        "リチウム",
        "Li",
        "lithium"
      ]
    },
    {
      "q": "ステンレスに不可欠な元素は？（Cr or Ni）",
      "a": [
        "クロム",
        "Cr",
        "ニッケル",
        "Ni"
      ]
    },
    {
      "q": "半導体産業で用いられる元素を一つ（Si, Ge, Ga）",
      "a": [
        "ケイ素",
        "Si",
        "ゲルマニウム",
        "Ge",
        "ガリウム",
        "Ga"
      ]
    },
    {
      "q": "はんだに使われる元素を一つ（Sn, Pb）",
      "a": [
        "スズ",
        "Sn",
        "鉛",
        "Pb"
      ]
    },
    {
      "q": "医療X線の遮蔽に使われる重い金属元素は？",
      "a": [
        "鉛",
        "Pb",
        "lead"
      ]
    },
    {
      "q": "触媒として有名な白金族元素を一つ",
      "a": [
        "白金",
        "Pt",
        "パラジウム",
        "Pd",
        "ロジウム",
        "Rh",
        "ルテニウム",
        "Ru",
        "イリジウム",
        "Ir",
        "オスミウム",
        "Os"
      ]
    },
    {
      "q": "サファイア・ルビーの発色に関わる元素を一つ",
      "a": [
        "クロム",
        "Cr",
        "鉄",
        "Fe",
        "チタン",
        "Ti"
      ]
    },
    {
      "q": "蛍光灯・フラッシュに使われる貴ガスを一つ",
      "a": [
        "ネオン",
        "Ne",
        "アルゴン",
        "Ar",
        "キセノン",
        "Xe",
        "クリプトン",
        "Kr"
      ]
    },
    {
      "q": "磁石（ネオジム磁石）に使われる元素は？",
      "a": [
        "ネオジム",
        "Nd",
        "鉄",
        "Fe",
        "ホウ素",
        "B"
      ]
    },
    {
      "q": "耐熱合金に使われる難融金属を一つ（W, Mo, Ta, Re）",
      "a": [
        "タングステン",
        "W",
        "モリブデン",
        "Mo",
        "タンタル",
        "Ta",
        "レニウム",
        "Re"
      ]
    },
    {
      "q": "青色LEDの材料に関わる元素を一つ（Ga, N, In）",
      "a": [
        "ガリウム",
        "Ga",
        "窒素",
        "N",
        "インジウム",
        "In"
      ]
    },
    {
      "q": "古代から知られる貴金属を一つ（Au, Ag, Cu）",
      "a": [
        "金",
        "Au",
        "銀",
        "Ag",
        "銅",
        "Cu"
      ]
    },
    {
      "q": "大気中で不燃性の希ガスは？（一つ）",
      "a": [
        "ヘリウム",
        "ネオン",
        "アルゴン",
        "クリプトン",
        "キセノン",
        "ラドン",
        "オガネソン"
      ]
    },
    {
      "q": "海水に多いハロゲン元素は？",
      "a": [
        "塩素",
        "Cl",
        "chlorine"
      ]
    },
    {
      "q": "歯科治療のアマルガム合金に使われた金属元素（歴史的）",
      "a": [
        "水銀",
        "Hg",
        "mercury",
        "銀",
        "Ag"
      ]
    },
    {
      "q": "スーパーの消毒液に含まれる元素（次亜塩素酸）",
      "a": [
        "塩素",
        "Cl"
      ]
    },
    {
      "q": "常温で液体の元素をすべて挙げよ（どれか一つで可）",
      "a": [
        "水銀",
        "Hg",
        "mercury",
        "臭素",
        "Br",
        "bromine"
      ]
    },
    {
      "q": "ハロゲン元素を一つ答えよ。",
      "a": [
        "フッ素",
        "塩素",
        "臭素",
        "ヨウ素",
        "アスタチン",
        "テネシン"
      ]
    },
    {
      "q": "アルカリ土類金属を一つ答えよ。",
      "a": [
        "ベリリウム",
        "マグネシウム",
        "カルシウム",
        "ストロンチウム",
        "バリウム",
        "ラジウム"
      ]
    },
    {
      "q": "不活性ガス（貴ガス）を一つ答えよ。",
      "a": [
        "ヘリウム",
        "ネオン",
        "アルゴン",
        "クリプトン",
        "キセノン",
        "ラドン",
        "オガネソン"
      ]
    },
    {
      "q": "リチウムイオン電池に必須の元素は？",
      "a": [
        "リチウム",
        "Li",
        "lithium"
      ]
    },
    {
      "q": "ステンレスに不可欠な元素は？（Cr or Ni）",
      "a": [
        "クロム",
        "Cr",
        "ニッケル",
        "Ni"
      ]
    },
    {
      "q": "半導体産業で用いられる元素を一つ（Si, Ge, Ga）",
      "a": [
        "ケイ素",
        "Si",
        "ゲルマニウム",
        "Ge",
        "ガリウム",
        "Ga"
      ]
    },
    {
      "q": "はんだに使われる元素を一つ（Sn, Pb）",
      "a": [
        "スズ",
        "Sn",
        "鉛",
        "Pb"
      ]
    },
    {
      "q": "医療X線の遮蔽に使われる重い金属元素は？",
      "a": [
        "鉛",
        "Pb",
        "lead"
      ]
    },
    {
      "q": "触媒として有名な白金族元素を一つ",
      "a": [
        "白金",
        "Pt",
        "パラジウム",
        "Pd",
        "ロジウム",
        "Rh",
        "ルテニウム",
        "Ru",
        "イリジウム",
        "Ir",
        "オスミウム",
        "Os"
      ]
    },
    {
      "q": "サファイア・ルビーの発色に関わる元素を一つ",
      "a": [
        "クロム",
        "Cr",
        "鉄",
        "Fe",
        "チタン",
        "Ti"
      ]
    },
    {
      "q": "蛍光灯・フラッシュに使われる貴ガスを一つ",
      "a": [
        "ネオン",
        "Ne",
        "アルゴン",
        "Ar",
        "キセノン",
        "Xe",
        "クリプトン",
        "Kr"
      ]
    },
    {
      "q": "磁石（ネオジム磁石）に使われる元素は？",
      "a": [
        "ネオジム",
        "Nd",
        "鉄",
        "Fe",
        "ホウ素",
        "B"
      ]
    },
    {
      "q": "耐熱合金に使われる難融金属を一つ（W, Mo, Ta, Re）",
      "a": [
        "タングステン",
        "W",
        "モリブデン",
        "Mo",
        "タンタル",
        "Ta",
        "レニウム",
        "Re"
      ]
    },
    {
      "q": "青色LEDの材料に関わる元素を一つ（Ga, N, In）",
      "a": [
        "ガリウム",
        "Ga",
        "窒素",
        "N",
        "インジウム",
        "In"
      ]
    },
    {
      "q": "古代から知られる貴金属を一つ（Au, Ag, Cu）",
      "a": [
        "金",
        "Au",
        "銀",
        "Ag",
        "銅",
        "Cu"
      ]
    },
    {
      "q": "大気中で不燃性の希ガスは？（一つ）",
      "a": [
        "ヘリウム",
        "ネオン",
        "アルゴン",
        "クリプトン",
        "キセノン",
        "ラドン",
        "オガネソン"
      ]
    },
    {
      "q": "海水に多いハロゲン元素は？",
      "a": [
        "塩素",
        "Cl",
        "chlorine"
      ]
    },
    {
      "q": "歯科治療のアマルガム合金に使われた金属元素（歴史的）",
      "a": [
        "水銀",
        "Hg",
        "mercury",
        "銀",
        "Ag"
      ]
    },
    {
      "q": "スーパーの消毒液に含まれる元素（次亜塩素酸）",
      "a": [
        "塩素",
        "Cl"
      ]
    },
    {
      "q": "常温で液体の元素をすべて挙げよ（どれか一つで可）",
      "a": [
        "水銀",
        "Hg",
        "mercury",
        "臭素",
        "Br",
        "bromine"
      ]
    },
    {
      "q": "ハロゲン元素を一つ答えよ。",
      "a": [
        "フッ素",
        "塩素",
        "臭素",
        "ヨウ素",
        "アスタチン",
        "テネシン"
      ]
    },
    {
      "q": "アルカリ土類金属を一つ答えよ。",
      "a": [
        "ベリリウム",
        "マグネシウム",
        "カルシウム",
        "ストロンチウム",
        "バリウム",
        "ラジウム"
      ]
    },
    {
      "q": "不活性ガス（貴ガス）を一つ答えよ。",
      "a": [
        "ヘリウム",
        "ネオン",
        "アルゴン",
        "クリプトン",
        "キセノン",
        "ラドン",
        "オガネソン"
      ]
    },
    {
      "q": "リチウムイオン電池に必須の元素は？",
      "a": [
        "リチウム",
        "Li",
        "lithium"
      ]
    },
    {
      "q": "ステンレスに不可欠な元素は？（Cr or Ni）",
      "a": [
        "クロム",
        "Cr",
        "ニッケル",
        "Ni"
      ]
    },
    {
      "q": "半導体産業で用いられる元素を一つ（Si, Ge, Ga）",
      "a": [
        "ケイ素",
        "Si",
        "ゲルマニウム",
        "Ge",
        "ガリウム",
        "Ga"
      ]
    },
    {
      "q": "はんだに使われる元素を一つ（Sn, Pb）",
      "a": [
        "スズ",
        "Sn",
        "鉛",
        "Pb"
      ]
    },
    {
      "q": "医療X線の遮蔽に使われる重い金属元素は？",
      "a": [
        "鉛",
        "Pb",
        "lead"
      ]
    },
    {
      "q": "触媒として有名な白金族元素を一つ",
      "a": [
        "白金",
        "Pt",
        "パラジウム",
        "Pd",
        "ロジウム",
        "Rh",
        "ルテニウム",
        "Ru",
        "イリジウム",
        "Ir",
        "オスミウム",
        "Os"
      ]
    },
    {
      "q": "サファイア・ルビーの発色に関わる元素を一つ",
      "a": [
        "クロム",
        "Cr",
        "鉄",
        "Fe",
        "チタン",
        "Ti"
      ]
    },
    {
      "q": "蛍光灯・フラッシュに使われる貴ガスを一つ",
      "a": [
        "ネオン",
        "Ne",
        "アルゴン",
        "Ar",
        "キセノン",
        "Xe",
        "クリプトン",
        "Kr"
      ]
    },
    {
      "q": "磁石（ネオジム磁石）に使われる元素は？",
      "a": [
        "ネオジム",
        "Nd",
        "鉄",
        "Fe",
        "ホウ素",
        "B"
      ]
    },
    {
      "q": "耐熱合金に使われる難融金属を一つ（W, Mo, Ta, Re）",
      "a": [
        "タングステン",
        "W",
        "モリブデン",
        "Mo",
        "タンタル",
        "Ta",
        "レニウム",
        "Re"
      ]
    },
    {
      "q": "青色LEDの材料に関わる元素を一つ（Ga, N, In）",
      "a": [
        "ガリウム",
        "Ga",
        "窒素",
        "N",
        "インジウム",
        "In"
      ]
    },
    {
      "q": "古代から知られる貴金属を一つ（Au, Ag, Cu）",
      "a": [
        "金",
        "Au",
        "銀",
        "Ag",
        "銅",
        "Cu"
      ]
    },
    {
      "q": "大気中で不燃性の希ガスは？（一つ）",
      "a": [
        "ヘリウム",
        "ネオン",
        "アルゴン",
        "クリプトン",
        "キセノン",
        "ラドン",
        "オガネソン"
      ]
    },
    {
      "q": "海水に多いハロゲン元素は？",
      "a": [
        "塩素",
        "Cl",
        "chlorine"
      ]
    },
    {
      "q": "歯科治療のアマルガム合金に使われた金属元素（歴史的）",
      "a": [
        "水銀",
        "Hg",
        "mercury",
        "銀",
        "Ag"
      ]
    },
    {
      "q": "スーパーの消毒液に含まれる元素（次亜塩素酸）",
      "a": [
        "塩素",
        "Cl"
      ]
    },
    {
      "q": "常温で液体の元素をすべて挙げよ（どれか一つで可）",
      "a": [
        "水銀",
        "Hg",
        "mercury",
        "臭素",
        "Br",
        "bromine"
      ]
    },
    {
      "q": "ハロゲン元素を一つ答えよ。",
      "a": [
        "フッ素",
        "塩素",
        "臭素",
        "ヨウ素",
        "アスタチン",
        "テネシン"
      ]
    },
    {
      "q": "アルカリ土類金属を一つ答えよ。",
      "a": [
        "ベリリウム",
        "マグネシウム",
        "カルシウム",
        "ストロンチウム",
        "バリウム",
        "ラジウム"
      ]
    },
    {
      "q": "不活性ガス（貴ガス）を一つ答えよ。",
      "a": [
        "ヘリウム",
        "ネオン",
        "アルゴン",
        "クリプトン",
        "キセノン",
        "ラドン",
        "オガネソン"
      ]
    },
    {
      "q": "リチウムイオン電池に必須の元素は？",
      "a": [
        "リチウム",
        "Li",
        "lithium"
      ]
    },
    {
      "q": "ステンレスに不可欠な元素は？（Cr or Ni）",
      "a": [
        "クロム",
        "Cr",
        "ニッケル",
        "Ni"
      ]
    },
    {
      "q": "半導体産業で用いられる元素を一つ（Si, Ge, Ga）",
      "a": [
        "ケイ素",
        "Si",
        "ゲルマニウム",
        "Ge",
        "ガリウム",
        "Ga"
      ]
    },
    {
      "q": "はんだに使われる元素を一つ（Sn, Pb）",
      "a": [
        "スズ",
        "Sn",
        "鉛",
        "Pb"
      ]
    },
    {
      "q": "医療X線の遮蔽に使われる重い金属元素は？",
      "a": [
        "鉛",
        "Pb",
        "lead"
      ]
    },
    {
      "q": "触媒として有名な白金族元素を一つ",
      "a": [
        "白金",
        "Pt",
        "パラジウム",
        "Pd",
        "ロジウム",
        "Rh",
        "ルテニウム",
        "Ru",
        "イリジウム",
        "Ir",
        "オスミウム",
        "Os"
      ]
    },
    {
      "q": "サファイア・ルビーの発色に関わる元素を一つ",
      "a": [
        "クロム",
        "Cr",
        "鉄",
        "Fe",
        "チタン",
        "Ti"
      ]
    },
    {
      "q": "蛍光灯・フラッシュに使われる貴ガスを一つ",
      "a": [
        "ネオン",
        "Ne",
        "アルゴン",
        "Ar",
        "キセノン",
        "Xe",
        "クリプトン",
        "Kr"
      ]
    },
    {
      "q": "磁石（ネオジム磁石）に使われる元素は？",
      "a": [
        "ネオジム",
        "Nd",
        "鉄",
        "Fe",
        "ホウ素",
        "B"
      ]
    },
    {
      "q": "耐熱合金に使われる難融金属を一つ（W, Mo, Ta, Re）",
      "a": [
        "タングステン",
        "W",
        "モリブデン",
        "Mo",
        "タンタル",
        "Ta",
        "レニウム",
        "Re"
      ]
    },
    {
      "q": "青色LEDの材料に関わる元素を一つ（Ga, N, In）",
      "a": [
        "ガリウム",
        "Ga",
        "窒素",
        "N",
        "インジウム",
        "In"
      ]
    },
    {
      "q": "古代から知られる貴金属を一つ（Au, Ag, Cu）",
      "a": [
        "金",
        "Au",
        "銀",
        "Ag",
        "銅",
        "Cu"
      ]
    },
    {
      "q": "大気中で不燃性の希ガスは？（一つ）",
      "a": [
        "ヘリウム",
        "ネオン",
        "アルゴン",
        "クリプトン",
        "キセノン",
        "ラドン",
        "オガネソン"
      ]
    },
    {
      "q": "海水に多いハロゲン元素は？",
      "a": [
        "塩素",
        "Cl",
        "chlorine"
      ]
    },
    {
      "q": "歯科治療のアマルガム合金に使われた金属元素（歴史的）",
      "a": [
        "水銀",
        "Hg",
        "mercury",
        "銀",
        "Ag"
      ]
    },
    {
      "q": "スーパーの消毒液に含まれる元素（次亜塩素酸）",
      "a": [
        "塩素",
        "Cl"
      ]
    },
    {
      "q": "常温で液体の元素をすべて挙げよ（どれか一つで可）",
      "a": [
        "水銀",
        "Hg",
        "mercury",
        "臭素",
        "Br",
        "bromine"
      ]
    },
    {
      "q": "ハロゲン元素を一つ答えよ。",
      "a": [
        "フッ素",
        "塩素",
        "臭素",
        "ヨウ素",
        "アスタチン",
        "テネシン"
      ]
    },
    {
      "q": "アルカリ土類金属を一つ答えよ。",
      "a": [
        "ベリリウム",
        "マグネシウム",
        "カルシウム",
        "ストロンチウム",
        "バリウム",
        "ラジウム"
      ]
    },
    {
      "q": "不活性ガス（貴ガス）を一つ答えよ。",
      "a": [
        "ヘリウム",
        "ネオン",
        "アルゴン",
        "クリプトン",
        "キセノン",
        "ラドン",
        "オガネソン"
      ]
    },
    {
      "q": "リチウムイオン電池に必須の元素は？",
      "a": [
        "リチウム",
        "Li",
        "lithium"
      ]
    },
    {
      "q": "ステンレスに不可欠な元素は？（Cr or Ni）",
      "a": [
        "クロム",
        "Cr",
        "ニッケル",
        "Ni"
      ]
    },
    {
      "q": "半導体産業で用いられる元素を一つ（Si, Ge, Ga）",
      "a": [
        "ケイ素",
        "Si",
        "ゲルマニウム",
        "Ge",
        "ガリウム",
        "Ga"
      ]
    },
    {
      "q": "はんだに使われる元素を一つ（Sn, Pb）",
      "a": [
        "スズ",
        "Sn",
        "鉛",
        "Pb"
      ]
    },
    {
      "q": "医療X線の遮蔽に使われる重い金属元素は？",
      "a": [
        "鉛",
        "Pb",
        "lead"
      ]
    },
    {
      "q": "触媒として有名な白金族元素を一つ",
      "a": [
        "白金",
        "Pt",
        "パラジウム",
        "Pd",
        "ロジウム",
        "Rh",
        "ルテニウム",
        "Ru",
        "イリジウム",
        "Ir",
        "オスミウム",
        "Os"
      ]
    },
    {
      "q": "サファイア・ルビーの発色に関わる元素を一つ",
      "a": [
        "クロム",
        "Cr",
        "鉄",
        "Fe",
        "チタン",
        "Ti"
      ]
    },
    {
      "q": "蛍光灯・フラッシュに使われる貴ガスを一つ",
      "a": [
        "ネオン",
        "Ne",
        "アルゴン",
        "Ar",
        "キセノン",
        "Xe",
        "クリプトン",
        "Kr"
      ]
    },
    {
      "q": "磁石（ネオジム磁石）に使われる元素は？",
      "a": [
        "ネオジム",
        "Nd",
        "鉄",
        "Fe",
        "ホウ素",
        "B"
      ]
    },
    {
      "q": "耐熱合金に使われる難融金属を一つ（W, Mo, Ta, Re）",
      "a": [
        "タングステン",
        "W",
        "モリブデン",
        "Mo",
        "タンタル",
        "Ta",
        "レニウム",
        "Re"
      ]
    },
    {
      "q": "青色LEDの材料に関わる元素を一つ（Ga, N, In）",
      "a": [
        "ガリウム",
        "Ga",
        "窒素",
        "N",
        "インジウム",
        "In"
      ]
    },
    {
      "q": "古代から知られる貴金属を一つ（Au, Ag, Cu）",
      "a": [
        "金",
        "Au",
        "銀",
        "Ag",
        "銅",
        "Cu"
      ]
    },
    {
      "q": "大気中で不燃性の希ガスは？（一つ）",
      "a": [
        "ヘリウム",
        "ネオン",
        "アルゴン",
        "クリプトン",
        "キセノン",
        "ラドン",
        "オガネソン"
      ]
    },
    {
      "q": "海水に多いハロゲン元素は？",
      "a": [
        "塩素",
        "Cl",
        "chlorine"
      ]
    },
    {
      "q": "歯科治療のアマルガム合金に使われた金属元素（歴史的）",
      "a": [
        "水銀",
        "Hg",
        "mercury",
        "銀",
        "Ag"
      ]
    },
    {
      "q": "スーパーの消毒液に含まれる元素（次亜塩素酸）",
      "a": [
        "塩素",
        "Cl"
      ]
    }
  ],
  "上級": [
    {
      "q": "ハロゲンで唯一、常温液体の元素は？",
      "a": [
        "臭素",
        "Br",
        "bromine"
      ]
    },
    {
      "q": "原子番号92の元素は？",
      "a": [
        "ウラン",
        "U",
        "uranium",
        "92"
      ]
    },
    {
      "q": "地殻に多い元素トップ2（どちらか一つ）",
      "a": [
        "酸素",
        "O",
        "ケイ素",
        "Si"
      ]
    },
    {
      "q": "ルビーの発色中心イオンは？",
      "a": [
        "クロム",
        "Cr"
      ]
    },
    {
      "q": "18族元素で化合物を作りやすい重い元素を一つ",
      "a": [
        "キセノン",
        "Xe",
        "クリプトン",
        "Kr"
      ]
    },
    {
      "q": "半金属（メタロイド）に分類される元素を一つ",
      "a": [
        "ホウ素",
        "B",
        "ケイ素",
        "Si",
        "ゲルマニウム",
        "Ge",
        "ヒ素",
        "As",
        "アンチモン",
        "Sb",
        "テルル",
        "Te",
        "ポロニウム",
        "Po"
      ]
    },
    {
      "q": "常磁性が強いランタノイド元素を一つ（Nd, Gd など）",
      "a": [
        "ネオジム",
        "Nd",
        "ガドリニウム",
        "Gd",
        "サマリウム",
        "Sm",
        "テルビウム",
        "Tb",
        "ジスプロシウム",
        "Dy"
      ]
    },
    {
      "q": "核燃料サイクルに関わるアクチノイドを一つ",
      "a": [
        "ウラン",
        "U",
        "プルトニウム",
        "Pu",
        "トリウム",
        "Th",
        "ネプツニウム",
        "Np",
        "アメリシウム",
        "Am"
      ]
    },
    {
      "q": "超重元素（原子番号>100）を一つ",
      "a": [
        "メンデレーウム",
        "Md",
        "ノーベリウム",
        "No",
        "ローレンシウム",
        "Lr",
        "ラザホージウム",
        "Rf",
        "ドブニウム",
        "Db",
        "シーボーギウム",
        "Sg",
        "ボーリウム",
        "Bh",
        "ハッシウム",
        "Hs",
        "マイトネリウム",
        "Mt",
        "ダームスタチウム",
        "Ds",
        "レントゲニウム",
        "Rg",
        "コペルニシウム",
        "Cn",
        "ニホニウム",
        "Nh",
        "フレロビウム",
        "Fl",
        "モスコビウム",
        "Mc",
        "リバモリウム",
        "Lv",
        "テネシン",
        "Ts",
        "オガネソン",
        "Og"
      ]
    },
    {
      "q": "希ガスを封入した放電管で青白い光を出す元素を一つ",
      "a": [
        "キセノン",
        "Xe",
        "アルゴン",
        "Ar"
      ]
    },
    {
      "q": "セシウムの元素記号は？",
      "a": [
        "Cs",
        "セシウム",
        "cesium"
      ]
    },
    {
      "q": "バリウムの元素記号は？",
      "a": [
        "Ba",
        "バリウム",
        "barium"
      ]
    },
    {
      "q": "ランタンの元素記号は？",
      "a": [
        "La",
        "ランタン",
        "lanthanum"
      ]
    },
    {
      "q": "セリウムの元素記号は？",
      "a": [
        "Ce",
        "セリウム",
        "cerium"
      ]
    },
    {
      "q": "プラセオジムの元素記号は？",
      "a": [
        "Pr",
        "プラセオジム",
        "praseodymium"
      ]
    },
    {
      "q": "ネオジムの元素記号は？",
      "a": [
        "Nd",
        "ネオジム",
        "neodymium"
      ]
    },
    {
      "q": "プロメチウムの元素記号は？",
      "a": [
        "Pm",
        "プロメチウム",
        "promethium"
      ]
    },
    {
      "q": "サマリウムの元素記号は？",
      "a": [
        "Sm",
        "サマリウム",
        "samarium"
      ]
    },
    {
      "q": "ユウロピウムの元素記号は？",
      "a": [
        "Eu",
        "ユウロピウム",
        "europium"
      ]
    },
    {
      "q": "ガドリニウムの元素記号は？",
      "a": [
        "Gd",
        "ガドリニウム",
        "gadolinium"
      ]
    },
    {
      "q": "テルビウムの元素記号は？",
      "a": [
        "Tb",
        "テルビウム",
        "terbium"
      ]
    },
    {
      "q": "ジスプロシウムの元素記号は？",
      "a": [
        "Dy",
        "ジスプロシウム",
        "dysprosium"
      ]
    },
    {
      "q": "ホルミウムの元素記号は？",
      "a": [
        "Ho",
        "ホルミウム",
        "holmium"
      ]
    },
    {
      "q": "エルビウムの元素記号は？",
      "a": [
        "Er",
        "エルビウム",
        "erbium"
      ]
    },
    {
      "q": "ツリウムの元素記号は？",
      "a": [
        "Tm",
        "ツリウム",
        "thulium"
      ]
    },
    {
      "q": "イッテルビウムの元素記号は？",
      "a": [
        "Yb",
        "イッテルビウム",
        "ytterbium"
      ]
    },
    {
      "q": "ルテチウムの元素記号は？",
      "a": [
        "Lu",
        "ルテチウム",
        "lutetium"
      ]
    },
    {
      "q": "ハフニウムの元素記号は？",
      "a": [
        "Hf",
        "ハフニウム",
        "hafnium"
      ]
    },
    {
      "q": "タンタルの元素記号は？",
      "a": [
        "Ta",
        "タンタル",
        "tantalum"
      ]
    },
    {
      "q": "タングステンの元素記号は？",
      "a": [
        "W",
        "タングステン",
        "tungsten"
      ]
    },
    {
      "q": "レニウムの元素記号は？",
      "a": [
        "Re",
        "レニウム",
        "rhenium"
      ]
    },
    {
      "q": "オスミウムの元素記号は？",
      "a": [
        "Os",
        "オスミウム",
        "osmium"
      ]
    },
    {
      "q": "イリジウムの元素記号は？",
      "a": [
        "Ir",
        "イリジウム",
        "iridium"
      ]
    },
    {
      "q": "白金の元素記号は？",
      "a": [
        "Pt",
        "白金",
        "platinum"
      ]
    },
    {
      "q": "金の元素記号は？",
      "a": [
        "Au",
        "金",
        "gold"
      ]
    },
    {
      "q": "水銀の元素記号は？",
      "a": [
        "Hg",
        "水銀",
        "mercury"
      ]
    },
    {
      "q": "タリウムの元素記号は？",
      "a": [
        "Tl",
        "タリウム",
        "thallium"
      ]
    },
    {
      "q": "鉛の元素記号は？",
      "a": [
        "Pb",
        "鉛",
        "lead"
      ]
    },
    {
      "q": "ビスマスの元素記号は？",
      "a": [
        "Bi",
        "ビスマス",
        "bismuth"
      ]
    },
    {
      "q": "ポロニウムの元素記号は？",
      "a": [
        "Po",
        "ポロニウム",
        "polonium"
      ]
    },
    {
      "q": "アスタチンの元素記号は？",
      "a": [
        "At",
        "アスタチン",
        "astatine"
      ]
    },
    {
      "q": "ラドンの元素記号は？",
      "a": [
        "Rn",
        "ラドン",
        "radon"
      ]
    },
    {
      "q": "フランシウムの元素記号は？",
      "a": [
        "Fr",
        "フランシウム",
        "francium"
      ]
    },
    {
      "q": "ラジウムの元素記号は？",
      "a": [
        "Ra",
        "ラジウム",
        "radium"
      ]
    },
    {
      "q": "アクチニウムの元素記号は？",
      "a": [
        "Ac",
        "アクチニウム",
        "actinium"
      ]
    },
    {
      "q": "トリウムの元素記号は？",
      "a": [
        "Th",
        "トリウム",
        "thorium"
      ]
    },
    {
      "q": "プロトアクチニウムの元素記号は？",
      "a": [
        "Pa",
        "プロトアクチニウム",
        "protactinium"
      ]
    },
    {
      "q": "ウランの元素記号は？",
      "a": [
        "U",
        "ウラン",
        "uranium"
      ]
    },
    {
      "q": "ネプツニウムの元素記号は？",
      "a": [
        "Np",
        "ネプツニウム",
        "neptunium"
      ]
    },
    {
      "q": "プルトニウムの元素記号は？",
      "a": [
        "Pu",
        "プルトニウム",
        "plutonium"
      ]
    }
  ]
};

// ----------- ユーティリティ（正規化） -----------
const kanaMap = { // 片仮名→平仮名
  'ァ':'ぁ','ィ':'ぃ','ゥ':'ぅ','ェ':'ぇ','ォ':'ぉ','ッ':'っ','ャ':'ゃ','ュ':'ゅ','ョ':'ょ','ヮ':'ゎ','ヵ':'か','ヶ':'け'
};
function toHiragana(str){
  return str.replace(/[ァ-ン]/g, s => String.fromCharCode(s.charCodeAt(0)-0x60))
            .replace(/[ヷヸヹヺ]/g, s => s) // 例外はそのまま
            .replace(/[ャュョァィゥェォッヮヵヶ]/g, s => kanaMap[s]||s);
}
function normalize(s){
  if(!s) return "";
  // 全角→半角（英数のみ）、トリム
  s = s.trim()
       .replace(/[Ａ-Ｚａ-ｚ０-９]/g, ch => String.fromCharCode(ch.charCodeAt(0)-0xFEE0))
       .toLowerCase();
  // 長音など削除、スペース詰め
  s = s.replace(/[‐‑–—―ー]/g,"-").replace(/\s+/g," ");
  // ひらがな正規化（カタカナ→ひらがな）
  s = toHiragana(s);
  return s;
}
function anyMatch(input, answers){
  const x = normalize(input);
  return answers.some(ans => normalize(ans) === x);
}

// ----------- ストレージ -----------
const KEY_BANK = "element_quiz_bank_v1";
const KEY_STATE_PREFIX = "element_quiz_state_";
function loadBank(){
  const saved = localStorage.getItem(KEY_BANK);
  if(saved){
    try { return JSON.parse(saved); } catch(e){ console.warn(e); }
  }
  return structuredClone(SAMPLE_BANK);
}
function saveBank(){
  localStorage.setItem(KEY_BANK, JSON.stringify(BANK));
}
function loadState(level){
  const raw = localStorage.getItem(KEY_STATE_PREFIX+level);
  if(!raw) return {shown:0,correct:0,order:[],cursor:0,seen:{}};
  try{ return JSON.parse(raw); }catch{ return {shown:0,correct:0,order:[],cursor:0,seen:{}}; }
}
function saveState(level){
  localStorage.setItem(KEY_STATE_PREFIX+level, JSON.stringify(STATE[level]));
}
function resetState(level){
  STATE[level] = {shown:0,correct:0,order:shuffle([...Array(BANK[level].length).keys()]),cursor:0,seen:{}};
  saveState(level);
}

// ----------- シャッフル -----------
function shuffle(arr){
  for(let i=arr.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
  return arr;
}

// ----------- DOM -----------
const levelsEl = document.getElementById("levels");
const qEl = document.getElementById("question");
const ansEl = document.getElementById("answer");
const resEl = document.getElementById("result");
const shownEl = document.getElementById("shown");
const correctEl = document.getElementById("correct");
const rateEl = document.getElementById("rate");
const leftpill = document.getElementById("leftpill");
const progbar = document.getElementById("progbar");
const previewEl = document.getElementById("bankPreview");
const bulkEl = document.getElementById("bulk");
const btnStart = document.getElementById("btnStart");
const btnSubmit = document.getElementById("btnSubmit");
const btnReveal = document.getElementById("btnReveal");
const btnNext = document.getElementById("btnNext");
const btnPass = document.getElementById("btnPass");
const btnReset = document.getElementById("btnReset");
const btnImport = document.getElementById("btnImport");
const btnExport = document.getElementById("btnExport");
const btnClearAll = document.getElementById("btnClearAll");

// ----------- 初期化 -----------
let BANK = loadBank();
let LEVELS = Object.keys(BANK);
let STATE = {}; // per level
LEVELS.forEach(lv => { STATE[lv] = loadState(lv); if(!STATE[lv].order || STATE[lv].order.length !== BANK[lv].length){ resetState(lv); } });

// レベルUI
let currentLevel = LEVELS[0] || "初級";
function renderLevels(){
  levelsEl.innerHTML = "";
  LEVELS.forEach(lv=>{
    const btn = document.createElement("button");
    btn.className = "lv-btn" + (lv===currentLevel ? " active": "");
    btn.textContent = lv;
    btn.onclick = ()=>{ currentLevel=lv; document.querySelectorAll(".lv-btn").forEach(b=>b.classList.remove("active")); btn.classList.add("active"); updateStats(); qEl.textContent = "「出題開始」を押してください。"; disablePlay(true); resEl.textContent=""; };
    levelsEl.appendChild(btn);
  });
}
renderLevels();
updatePreview();
updateStats();
disablePlay(true);

// ----------- 出題ロジック -----------
let currentIndex = null; // 問題インデックス（BANK[currentLevel]内）
function start(){
  ensureOrder();
  disablePlay(false);
  next();
}
function ensureOrder(){
  const L = BANK[currentLevel].length;
  const st = STATE[currentLevel];
  // 長さが変わったら再シャッフル
  if(!st.order || st.order.length!==L){
    resetState(currentLevel);
  }
}
function next(){
  const st = STATE[currentLevel];
  ensureOrder();
  if(st.cursor>=st.order.length){
    qEl.textContent = "このレベルの全問題を解きました！「このレベルをリセット」で再挑戦できます。";
    disablePlay(true);
    return;
  }
  currentIndex = st.order[st.cursor];
  const item = BANK[currentLevel][currentIndex];
  qEl.textContent = item.q;
  ansEl.value = ""; ansEl.focus();
  resEl.textContent = "";
  btnReveal.disabled=false;
  btnNext.disabled=true;
  btnPass.disabled=false;
}
function submit(){
  if(currentIndex===null) return;
  const item = BANK[currentLevel][currentIndex];
  const ok = anyMatch(ansEl.value, item.a||[]);
  const st = STATE[currentLevel];
  if(!(currentIndex in st.seen)){ st.seen[currentIndex]=true; st.shown++; }
  if(ok){ st.correct++; resEl.textContent = "正解！"; resEl.className = "result ok"; btnNext.disabled=false; btnPass.disabled=true; }
  else { resEl.textContent = "不正解…"; resEl.className = "result ng"; }
  updateStats();
  if(ok){ st.cursor++; saveState(currentLevel); }
}
function passQ(){
  const st=STATE[currentLevel];
  if(!(currentIndex in st.seen)){ st.seen[currentIndex]=true; st.shown++; }
  st.cursor++; saveState(currentLevel);
  updateStats();
  next();
}
function reveal(){
  if(currentIndex===null) return;
  const item = BANK[currentLevel][currentIndex];
  resEl.innerHTML = "答え例：<b>"+ (item.a||[]).join("</b> / <b>") + "</b>";
  resEl.className = "result";
  btnNext.disabled=false;
  btnPass.disabled=true;
}

// ----------- 表示/統計 -----------
function updateStats(){
  const st = STATE[currentLevel];
  shownEl.textContent = st.shown;
  correctEl.textContent = st.correct;
  const rate = st.shown ? Math.round(st.correct/st.shown*100) : 0;
  rateEl.textContent = rate + "%";
  const left = Math.max(0, (BANK[currentLevel].length - st.cursor));
  leftpill.textContent = "残り："+left;
  const p = BANK[currentLevel].length ? Math.round(st.cursor/BANK[currentLevel].length*100) : 0;
  progbar.style.width = p + "%";
}
function disablePlay(disabled){
  ansEl.disabled = disabled;
  btnSubmit.disabled = disabled;
  btnReveal.disabled = disabled;
  btnNext.disabled = disabled;
  btnPass.disabled = disabled;
}

// ----------- 取込/書出/初期化 -----------
function parseBulk(text){
  const lines = text.split(/\r?\n/).filter(l=>l.trim().length>0);
  const added = [];
  for(const line of lines){
    // CSV or TSV
    const parts = line.split(/\t|,(?![^"]*"(?:(?:[^"]*"){2})*[^"]*$)/); // タブ or カンマ（簡易）
    if(parts.length<3) continue;
    const lv = parts[0].trim() || "初級";
    const q = parts[1].trim();
    const a = parts.slice(2).join(",").split("|").map(s=>s.trim()).filter(Boolean);
    if(!BANK[lv]) BANK[lv]=[];
    BANK[lv].push({q,a});
    added.push({lv,q,a});
  }
  // レベルと状態更新
  LEVELS = Object.keys(BANK);
  LEVELS.forEach(lv=>{ if(!STATE[lv]) resetState(lv); else { // 長さ変化に対応
    if(STATE[lv].order.length!==BANK[lv].length){ resetState(lv); }
  }});
  saveBank();
  renderLevels();
  updatePreview();
  return added.length;
}
function updatePreview(){
  let html = "";
  for(const lv of Object.keys(BANK)){
    html += `<div><b>${lv}</b>（${BANK[lv].length}件）</div>`;
    BANK[lv].slice(0,10).forEach((it,i)=>{
      html += `<div>・${escapeHtml(it.q)} <span class="muted">[${(it.a||[]).join(" / ")}]</span></div>`;
    });
    if(BANK[lv].length>10){ html += `<div class="muted">…ほか ${BANK[lv].length-10}件</div>`; }
    html += "<hr />";
  }
  previewEl.innerHTML = html || "<i>まだ問題がありません。</i>";
}
function exportJSON(){
  const blob = new Blob([JSON.stringify(BANK,null,2)], {type:"application/json"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url; a.download = "elements_quiz_bank.json";
  a.click();
  URL.revokeObjectURL(url);
}
function clearAll(){
  if(!confirm("全問題と進捗を完全に消去します。よろしいですか？")) return;
  localStorage.removeItem(KEY_BANK);
  Object.keys(localStorage).forEach(k=>{ if(k.startsWith(KEY_STATE_PREFIX)) localStorage.removeItem(k); });
  BANK = structuredClone(SAMPLE_BANK);
  LEVELS = Object.keys(BANK);
  STATE = {};
  LEVELS.forEach(lv=> resetState(lv));
  currentLevel = LEVELS[0];
  renderLevels(); updatePreview(); updateStats(); qEl.textContent="初期化しました。レベルを選び「出題開始」を押してください。"; disablePlay(true);
}

// ----------- 小物 -----------
function escapeHtml(str){ return (str||"").replace(/[&<>"']/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[m])); }

// ----------- イベント -----------
btnStart.addEventListener("click", start);
btnSubmit.addEventListener("click", submit);
btnReveal.addEventListener("click", reveal);
btnNext.addEventListener("click", ()=>{ const st=STATE[currentLevel]; st.cursor++; saveState(currentLevel); updateStats(); next(); });
btnPass.addEventListener("click", passQ);
btnReset.addEventListener("click", ()=>{ if(confirm("このレベルの進捗をリセットしますか？")){ resetState(currentLevel); updateStats(); next(); }});
btnImport.addEventListener("click", ()=>{
  const n = parseBulk(bulkEl.value);
  alert(n+"件を追加しました。");
  bulkEl.value="";
});
btnExport.addEventListener("click", exportJSON);
btnClearAll.addEventListener("click", clearAll);

ansEl.addEventListener("keydown",(e)=>{
  if(e.key==="Enter" && !e.ctrlKey){ e.preventDefault(); submit(); }
  else if(e.key==="Enter" && e.ctrlKey){ e.preventDefault(); const st=STATE[currentLevel]; st.cursor++; saveState(currentLevel); updateStats(); next(); }
  else if(e.key==="Escape"){ e.preventDefault(); passQ(); }
});

// 初回フォーカス
document.addEventListener("keydown",(e)=>{ if(e.key==="Enter" && btnStart){ /* noop */ }});
</script>
</body>
</html>
